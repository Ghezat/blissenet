<!DOCTYPE html>
<html lang="en">

<head> 
    <!-- storeProfile[0].username -->
    <meta property="og:title" content="<%= storeProfile.username %>">
    <meta property="og:type" content="website">
    <meta property="og:description" content="Visita mi tienda en Blissenet.com">
    <meta property="og:image" content="<%= searchBanner[0].url %>">
    <meta property="og:url" content="https://blissenet.com/account/<%= storeProfile.username %>">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="<%= storeProfile.username %>">
    <meta name="twitter:description" content="Visita mi tienda en Blissenet.com">
    <meta name="twitter:image" content="<%= searchBanner[0].url %>">
    <meta name="twitter:url" content="https://blissenet.com/account/<%= storeProfile.username %>">

        
    <%- include('../partials/head.ejs') %>
    <title>Blissenet Account</title>
</head>
<style>

  *{
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  body{
    scroll-behavior: smooth;
    max-width: 100vw;
    height: auto;
  }

  main{
    width: 100%;
    height: auto;
  }

  .popover {
    position: relative; /* o relative, según tu diseño */
    z-index: 110; /* valor que necesites */
    /*para que z-index funcione debe ir acompañado de un valor en la propiedad position*/
  }

  
  .btnMaskSeguir{
    opacity: 0;
  }

  .btnMaskSiguiendo{
    opacity: 0;
  }



  .containerBanner:hover{
  
     .starData{
      opacity: 1;
     }
     .containerStar{
      opacity: 1;
     }

  }

 
  .starData{
    opacity: 0;
    transition: 1s all ease;
  }

  .containerStar{
    opacity: 0;
    cursor: pointer;
    background-color: rgb(255, 255, 255);
    transition: 1s all ease;
  }

  .imgPerfil {
    width: 70px;
    border-radius: 4px;
  }

  .horizontal-list { 
    display: flex;
  }


  .containerShare  { 
    background-color: rgba(255, 255, 255, 0.8); position: absolute; top: 5px; left:250px; z-index: 220;
  }

  .nailUpp{
    /* background-color: rgb(240, 240, 240, 0.3); */
    transition: 1.5s ease all;
    border-bottom-left-radius: 4px;
    border-bottom-right-radius: 4px;
  }
 
  .nailUpp:hover{
   /*  background-color: rgb(240, 240, 240, 0.5); */
    cursor: pointer;
  }
 
  .departGroup {
    background-color: rgb(197, 103, 103);
    border: 1px ridge #a52a2a;
    list-style: none;
    margin: 0;
  }

  .departList {
    background-color: rgb(243, 205, 205);
    padding: 0px 8px;
    color: rgb(54, 52, 49);
    border-radius: 12px;
  }

  .textDecorativeNo {
    text-decoration: none;
  }

  .contentAdmin {
    display: flex;
    justify-content: center;
  }

  .contentAnalisys {
    display: flex;
    flex-direction: row;
    justify-content: space-evenly;
  }

  .open {
    display: block;
  }

  .closed {
    display: none;

  }

  .containerIconSetting{
    background-color: rgb(255, 255, 255, 0);
    transition: 1s ease background-color;
  }

  .containerIconSetting:hover{
    background-color: rgb(255, 255, 255, 0.4);
  }


    .carousel .carousel-control-prev {
      position: absolute;
      left: 20px;
      left: 1%;
      z-index: 1;
      width: 20px;
    }

    .carousel .carousel-control-next {
      position: absolute;
      width: 20px;
      right: 1%;
      z-index: 1;
      width: 20px;
      
    }

    .cardPublished{
      width: 220px;

      .setting{
      opacity: 0;
      transition: 0.5s ease all;
      }
    }

    .imgFront{
      width: 220px; height: auto;
      transition: .5s ease width;
    }

    .cardPublished:hover{
      outline: 2px solid lightskyblue;

      .setting{
      cursor: pointer;
      background-color: white;
      opacity: 1;
      }

      .imgFront{
        width: 230px;
      }
    }

    .contentClean{
      transition: 0.5s ease background-color;
    }

    .contentClean:hover{
      background-color: rgba(165, 42, 42, 0.8);
    }

    .textLight{
      /* trabaja en conjunto con themaTextLight */
      color: white;
    }

    .lupaSinRespuesta{
      animation: moverLupa 8s infinite;
      transform-origin: center; /* Establecer el eje central para rotar */
    }


    @keyframes moverLupa {
          0% {
              transform: rotate(0deg);
          }
          20% {
              transform: rotate(25deg); /* Rota hacia arriba */
          }
          40% {
              transform: rotate(0deg); /* Regresa a la posición original */
          }
          60% {
              transform: rotate(-25deg); /* Rota hacia abajo */
          }
          100% {
              transform: rotate(0deg); /* Regresa a la posición original */
          }
      }

    
    .containerRRSS{
      display: flex;
      justify-content: end;
    }


   /*  Media queries */
   @media screen and (min-width: 500px) and (max-width: 700px ){

    .TopbarMain{
      flex-direction: column;
    }

    .containerAvatarUser{
      width: auto !important;
    }

   
    .MessagerStore{
      text-align: justify;
    }

    .container{
      width: 100% !important;
      padding: 0;
    }

    footer{
      display: flex;
      flex-direction: column;
      padding: 15px 0 15px 0;
    }

    .contentUser{
      width: 100% !important;
      margin-bottom: 20px !important;
    }

    .contentPlatform{
      width: 100% !important;
    }

    .containerRRSS{
      display: flex;
      justify-content: end;
    }


   }
    

   @media screen and (min-width: 290px) and (max-width: 499px ){

    .TopbarMain{
      flex-direction: column;
    }

    .containerAvatarUser{
      width: auto !important;
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
    }

    .containerAvatar{
      margin: 0 !important;
    }

   
    .MessagerStore{
      text-align: left !important;
    }

    .container{
      width: 100% !important;
      padding: 0;
    }

    .containerShare{
      /* esto pertenece al modulo de compartir */
      background-color: rgba(255, 255, 255, 0.8); position: absolute; top: 65px; left: 10px; z-index: 220;
      /* right: 3px;
      background-color: rgba(255, 255, 255, 0.9); position: absolute; top: 30px; left:-200px; z-index: 220; */
    }


    footer{
      display: flex;
      flex-direction: column;
      padding: 15px 0 15px 0;
    }

    .contentUser{
      width: 100% !important;
      margin-bottom: 20px !important;
    }

    .contentPlatform{
      width: 100% !important;
      border: none !important;
    }

    .containerRRSS{
      margin: 10px 0;
      display: flex;
      justify-content: center;
    }

  }

</style>

<body>

  <main class="mainTheme" >
    

    <%- include('../partials/navi-simple.ejs') %>

    <audio src="/sound/Icon-efect.mp3" id="efectSoundExpan"></audio> 

      <% if (storeProfile) { %>
        <div class="container-fluid p-0 m-0">
          <div class="row rowWidth mx-0 p-0">

              <div class="col-sm-12 col-md-12 col-lg-12 col-xl-12 px-0">

                <div class="containAlert" style="position: sticky; top: 0px; z-index: 200;"> <!-- bloque dinamico --> </div>
                <div class="containerBanner" style="position: relative; z-index: 220">
                    <% if (user) { %>
                        <% if (searchBanner) { %>

                          <img src="<%= searchBanner[0].url %>" style="width: 100%;">
                        
                        <% } %>
                    <% } else { %> 
                        <% if (searchBanner) { %>

                          <img src="<%= searchBanner[0].url %>" style="width: 100%;">
              
                        <% }; %>

                    <% }; %> <!-- fin del user --> 
                </div>

              </div>
           
              <div class="col-sm-12 col-md-12 col-lg-12 col-xl-12 px-0">

                <!-- bloque Topbar -->
                <div class="TopbarMain p-1 d-flex justify-content-between px-4"
                  style="position: relative; background-color: <%= storeProfile.bGColorTopbar%> ; color: <%= storeProfile.bGColorText %>; position: relative; z-index: 200;">
                  
                    <div class="containerAvatarUser d-flex" style="width: 30%;">
                        <div class="containerAvatar me-2 d-flex align-items-center" style="margin-left: 20px;">

                          <% if (storeProfile.avatarPerfil[0].url.length === 0 ) { %>
                           <td> <img src="https://www.gravatar.com/avatar/<%= storeProfile.mailhash %>?d=identicon" style="width: 70px;"></td>    
                            <% } else { %>
                              <td><img src="<%= storeProfile.avatarPerfil[0].url %>" alt="" class="rounded-pill" style="width: 70px;"></td> 
                          <% }; %>

               <!-- este es el fin del foreach de colores -->
                        </div>
                        <div class="containerDetails d-flex flex-column">
                        <% if (Account) { %> 
                            <% Account.forEach((ele)=>{ %>
                                  <span class="mx-1 store" style="font-size: 20px;">
                                      <%= ele.username %> <input type="hidden" value="<%= ele.username %>">
                                  </span>
                                  <!-- <span class="mx-1" style="font-size: 16px;">@<%= ele.username %> </span> -->

                                  <div class="d-flex justify-content-start">

                                    <button class="mx-1 shareToggle" style="user-select: none; background: none; border: none; padding: 0; margin: 0; color: inherit"> <i class="bi bi-share me-1"></i>  Compartir </button> 
                                    
                                    <div class="containerShare d-flex invisible border border-secondary py-3 px-2 rounded-3" style="height: 80px;">
                                          <a href="https://api.whatsapp.com/send?text=https://blissenet.com/account/<%= ele.username %>" target="_blank" class="mx-2"> <img src="/img/helpWhatsapp.png" alt="" style="width: 42px; height: 42px;">   </a> 
                                          <a href="https://t.me/share/url?url=https://blissenet.com/account/<%= ele.username %>" target="_blank" class="mx-2"> <img src="/img/helpTelegram.png" alt="" style="width: 42px; height: 42px"> </a> 
                                          <a href="https://www.facebook.com/sharer/sharer.php?u=https://blissenet.com/account/<%= ele.username %>" target="_blank" class="mx-2"> <img src="/img/helpFacebook.png" alt="" style="width: 42px; height: 42px">  </a>
                                          <div class="containerBTN p-0 mx-2" style="position: relative; width: 43px !important">   
                                            <button class="btn btn-sm btn-primary" style="border-radius: 8px; position: absolute; right: - 200px; width: 42px; height: 42px" id="btnClicBoard"> <i class="bi bi-clipboard px-1" style="font-size: large;"></i> </button>
                                            <button class="btn btn-sm btn-dark invisible" style="border-radius: 8px; position: absolute; right: - 200px; width: 42px; height: 42px" id="btnClicBoardCheck"> <i class="bi bi-clipboard-check px-1" style="font-size: large;"></i>  </button>
                                          </div>
                                          <button class="btn btn-dark mx-2" id="btnQR" style="width: 42px; height: 42px ; border-radius: 8px;"  data-bs-toggle="modal" data-bs-target="#staticQR"> <i class="bi bi-qr-code px-0" style="font-size: large;"></i> </button>
                                    </div>
                                    <input type="hidden" id="linkToShare" value="https://blissenet.com/account/<%= ele.username %>">

                                  </div>

                                <% if (boxPublisher) { %>
                                    <span class="mx-1" style="font-size: 16px; user-select: none"><i class="bi bi-bag-plus me-1"></i> Anuncios: <%= boxPublisher.length %> </span>
                                <% }; %>
                            <% }) %>
                        <% }; %>
                        </div>
                    </div>


                    <% if (user) { %>
                      <input type="hidden" id="iDLogeado" value="<%= user._id %>">
                      <% if (storeProfile) { %>
                        <input type="hidden" id="iDStore" value="<%= storeProfile.indexed %>">
                        
                        <!-- estos datos ocultos se usan para jugar con los estilos el bton buttonFollow abajo presente -->
                        <input type="hidden" id="bGColorText" value="<%= storeProfile.bGColorText %>">
                        <input type="hidden" id="bGColorTopbar" value="<%= storeProfile.bGColorTopbar %>">


                        
                        <% if (statusFollow !== null) { %>
                            <div class="content-btn mt-3 cursor-pointer me-5" id="btnFollow" style = "width: max-content; height: max-content; position: relative;">
                                <button class="btn rounded-pill shadow-sm px-4 buttonFollow" style="background-color: #131313; color: #ffffff; border: 1px solid #ffffff"> <span id= "spanBtnFollow"> Siguiendo </span>  </button>
                                <div class = "contentConfetyFollow" style="position: absolute; top: -20px; left: -35px; width: 180px; height: 90px;">  </div>  
                            </div>
                        <% } else { %>
                            <div class="content-btn mt-3 cursor-pointer me-5" id="btnFollow" style = "width: max-content; height: max-content; position: relative;">
                                <button class="btn rounded-pill shadow-sm px-4 buttonFollow"  style="border: 1px solid <%= storeProfile.bGColorText %>; color: <%= storeProfile.bGColorText %>; background-color:<%= storeProfile.bGColorTopbar %>;"> <span id= "spanBtnFollow"> Seguir </span>  </button>
                                <div class = "contentConfetyFollow" style="position: absolute; top: -20px; left: -35px; width: 180px; height: 90px;">  </div>  
                            </div>
                        <% }; %>
                      

                      <% } %>  
                    <% } else { %>

                      <div class="content-btn-follow mt-3 me-5" style = "position: relative;">
                      
                        <button class="btn rounded-pill shadow-sm px-4"  style="border: 1px solid <%= storeProfile.bGColorText %>; color: <%= storeProfile.bGColorText %>; background-color:<%= storeProfile.bGColorTopbar%>;">Seguir</button>
                        <div class = "contentConfetyFollow" style="position: absolute; top: -20px; left: -35px; width: 180px; height: 90px;">  </div>  
                      
                    </div>
                    <% }; %>  
                    

        
                </div> <!-- aqui cierra el bloque Topbar--> 
                <% if (storeProfile) { %>
                    <% const store_username = storeProfile.username %>
                    <% const store_id = storeProfile.indexed %>

                    <form  method="get" id="formSegment"> <!-- acti0n se forma abajo en un script -->
                        <input type="hidden" value="<%= store_username %>" id="store_username">
                        <input type="hidden" value="<%= store_id %>" name="store" id="store_indexed">  

                        <div class="form-floating shadow-sm" style="position: relative; z-index: 200;">
                            <select class="form-select" id="floatingSelect" name="segment" aria-label="label select example"
                            style="border: none; outline: none; border-radius: 0; background-color: <%= storeProfile.bGColorTopbar%> ; color: <%= storeProfile.bGColorText %>; ">
                            
                              
                            <% if (segment) { %> <!-- esto es un objeto que viebe del backend -->
                              <option value= "<%= segment %>" selected> <%= segment %>  </option>
                            <% }; %>  

                            <% storeProfile.segment.forEach((Segment)=>{ %>
                              <option value= "<%= Segment %>"> <%= Segment %>  </option>
                            <% }) %>

                            </select>
                            <label for="floatingSelect" style="color: <%= storeProfile.bGColorText %>; "><i>Selecciona un Segmento</i> </label>
                        </div>
                    </form>    

                <% }; %>
                
               
                    
                  <!-- //storeProfile camiar por storeProfile --> 


                  <!-- importante que estos modales esten aqui afuera del contenedor containerWorkSpace -->
                      <!-- Modal codigo QR -->
                      <div class="modal fade" id="staticQR" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticQRLabel" aria-hidden="true">
                        <div class="modal-dialog border border-secondary p-2 rounded-3" style="background-color: rgb(0, 0, 0, 0.3);">
                            <div class="modal-content">
                                <div class="modal-header">
                                  <h5 class="modal-title" id="staticComprarLabel">Codigo QR</h5>
                                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                
                                <div class="modal-body d-flex justify-content-center align-items-center py-5" style="background: linear-gradient(90deg, rgba(146,0,255,1) 0%, rgba(102,0,255,1) 100%);">
                                    <div class="contentQR d-flex flex-column my-2" style="position: relative; max-width: 320px;">
                                      <canvas id="qr-canvas" class="rounded-3 mt-2">  
                                        <!-- Aqui va el codigo QR dinamico -->
                                      </canvas>
                                      <img src="/img/logoSuperiorQR.png" class="shadow" alt="" style="position: absolute; top: -35px; right: 70px; width: 60px;"> 
                                    </div>
                                </div>
                            </div>
                        </div>
                      </div>

                      <!-- Modal status de nivel  data-bs-toggle="modal" data-bs-target="#staticLevelSell" -->
                      <div class="modal fade" id="staticLevelSell" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticLevelSell" aria-hidden="true">
                        <div class="modal-dialog border border-secondary p-2 rounded-3" style="background-color: rgb(0, 0, 0, 0.3);">
                            <div class="modal-content">
                                <div class="modal-header">
                                  <h5 class="modal-title" id="staticComprarLabel">Récor como vendedor </h5>
                                  <button type="button" class="btn-close" id="closeModalStaticLevelSell" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body d-flex justify-content-around align-items-center mb-0">
                                  <p class="my-1"> Esta métrica indica que tan habilidoso es la administración de esta tienda, su capacidad de vender. Este nivel inicia en Carbón (pocas ventas realizadas) y termina en Diamante (Muchas ventas logradas +200). <span class="bg-dark rounded-pill text-info py-0 px-2 cursor-pointer seeLevel" data-bs-toggle="modal" data-bs-target="#staticScalafon">  Ver Niveles </span> </p> 
                                </div>
                                <div class="containerMessage">
                                  <hr>
                                  <p class="mx-3">"Recuerde que esta información no refleja la confiabilidad de la tienda. Considere el nivel de confianza  (<i class="bi bi-shield-check mx-1" style="font-size: 1rem;"></i>)  y los comentarios de sus clientes (<i class="bi bi-star-fill mx-1" style="font-size: 1rem;"></i>). Tómese su tiempo para revisar todos los indicadores y calificaciones antes de comprar."</p>
                                </div>
                            </div>
                        </div>
                      </div>

                      <!-- Modal status de nivel  data-bs-toggle="modal" data-bs-target="#staticScalafon" -->
                      <div class="modal fade" id="staticScalafon" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticScalafon" aria-hidden="true">
                        <div class="modal-dialog border border-secondary p-2 rounded-3" style="background-color: rgb(0, 0, 0, 0.3);">
                            <div class="modal-content">
                                <div class="modal-header">
                                  <h5 class="modal-title" id="staticComprarLabel">Niveles </h5>
                                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body d-flex justify-content-around align-items-center">
                                  <img src="/img/scalafon.png" alt="niveles" style="max-width: 90%;">
                                </div>
                                <div class="details d-flex justify-content-start">
                                  <span class="mx-3"> <small> <i>Las cantidades expresadas en los niveles representan las ventas realizadas.</i> </small> </span>
                                </div>
                                
                                <div class="containerMessage">
                                  <hr>
                                  <p class="mx-3">Puedes ver tu nivel en Publicaciones opción Record. </p>
                                </div>
                            </div>
                        </div>
                      </div>                       
                      
                      <!-- Modal status de nivel  data-bs-toggle="modal" data-bs-target="#staticTrustSell" -->
                      <div class="modal fade" id="staticTrustSell" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticTrustSell" aria-hidden="true">
                        <div class="modal-dialog border border-secondary p-2 rounded-3" style="background-color: rgb(0, 0, 0, 0.3);">
                            <div class="modal-content">
                                <div class="modal-header">
                                  <h5 class="modal-title" id="staticComprarLabel">Nivel de confianza</h5>
                                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body d-flex justify-content-around align-items-center my-2">
                                  "La confiabilidad se expresa en porcentajes del 100% (máxima confianza) al 0% (mínima confianza). Si no hay información, es porque no ha habido intercambios comerciales calificados".
                                </div>
                                <div class="containerMessage">
                                  <hr>
                                  <p class="mx-3">Esta información es valiosa, ya que muestra la confiabilidad de la tienda. ¡No olvides revisar los comentarios de sus clientes en la sección de <b>Calificación de Tienda <span class="bg-dark rounded-pill text-info px-2 py-1"> (Estrella <i class="bi bi-star-fill" style="font-size: 1rem; color: #fcda57;"></i>). </span>  </b> </p>
                                </div>
                            </div>
                        </div>
                      </div>                           

                      <!-- Option Rate -->
                      <div class="modal fade" id="staticOption" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticOptionRate" aria-hidden="true">
                        <div class="modal-dialog border border-secondary p-2 rounded-3" style="background-color: rgb(0, 0, 0, 0.3);">
                            <div class="modal-content">
                                <div class="modal-header">
                                  <h5 class="modal-title" id="staticComprarLabel">Opciones de Calificación</h5>
                                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body d-flex justify-content-around align-items-center my-3">

                                <% if (searchProfile) { %>  
                                  <% if (searchProfile.length !== 0) { %>
                                  <div class="containerMake d-flex flex-column justify-content-center align-items-center cursor-pointer" data-bs-toggle="modal" data-bs-target="#staticRate" data-bs-dismiss="modal" aria-label="Close">
                                    <img src="/img/rate-makeRate.png" alt="" style="width: 80px;">
                                    <span class="mt-2">Dejar Calificación</span>
                                  </div>
                                  <% } %>
                                <% } %>  

                                  <div class="containerMake d-flex flex-column justify-content-center align-items-center cursor-pointer" id="viewRateStore" data-bs-dismiss="modal" aria-label="Close"> 
                                    <img src="/img/rate-viewRate.png" alt=""  style="width: 80px;">
                                    <span class="mt-2">Ver Calificaciones</span>
                                  </div> 

                                </div>
                                <div class="containerMessage">
                                  <hr>
                                  <p class="mx-4">Es importante para la comunidad tu calificación y opinión sobre esta tienda. Deja saber al resto que tan confiable o bueno es el servicio de esta tienda.</p>
                                </div>
                            </div>
                        </div>
                      </div>

                      <!-- Modal de Calificacion de Tienda -->
                      <div class="modal fade" id="staticRate" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticComprarLabel" aria-hidden="true">
                          <div class="modal-dialog border border-secondary p-2 rounded-3" style="background-color: rgb(0, 0, 0, 0.3);">
                              <div class="modal-content">
                                  <div class="modal-header">
                                    <h5 class="modal-title" id="staticComprarLabel">Calificar esta Tienda</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                  </div>
                                  <div class="modal-body">
                                    <p> Puedes calificar esta tienda cada vez que quieras. ¡Dejanos saber tu Calificación y Opinión!</p>

                                    <div class="contentToolStart d-flex border">
                                      <div class="contentClean">
                                        <i class="bi bi-eraser mx-2" style="font-size: 1.4rem; cursor: pointer;"></i></i>
                                      </div>
                                      <div class="containRateStar d-flex justify-content-center border" style="width: 100%;">
                                        <i class="starE bi bi-star mx-2" style="font-size: 1.4rem; cursor: pointer;"></i>
                                        <i class="starE bi bi-star mx-2" style="font-size: 1.4rem; cursor: pointer;"></i>
                                        <i class="starE bi bi-star mx-2" style="font-size: 1.4rem; cursor: pointer;"></i>
                                        <i class="starE bi bi-star mx-2" style="font-size: 1.4rem; cursor: pointer;"></i>
                                        <i class="starE bi bi-star mx-2" style="font-size: 1.4rem; cursor: pointer;"></i> 
                                      </div> 
                                    </div>
                                    <div class="contentComment my-2 form-group">
                                      <textarea class="form-control comment" placeholder="¡Deje aqui su comentario!. Max 400 caracteres." cols="2" maxlength="400"></textarea>
                                    </div>

                                  </div>
                                  <div class="modal-footer">
                                      <button type="button" class="btn btn-success" data-bs-dismiss="modal" id="btnSendStar" disabled>Enviar Calificación</button>
                                  </div>
                              </div>
                          </div>
                      </div>                      

                  <div class="containerWorkSpace">
                    <!-- bloque Workspace -->
                    <div class="WorkspaceMain closed d-flex flex-column justify-content-center align-items-center" style="height: auto; background-color:<%= storeProfile.bGColorWorkspace %>; position: relative;">

                          <a name="workSpace"></a>

                          <!-- Este bloque es para acceder a un buscador dentro de la misma tienda, será una opcion del profile -->
                          <% if (storeProfile.searchFilter === 'on' ){%>
                          <div class="containerSearch d-flex justify-content-center align-items-center p-1" style="height: 60px; width: 100%; background-color:<%= storeProfile.bGColorTopbar%>;color:<%= storeProfile.bGColorText %>; z-index : 100">

                              <div class="container-fluid">
                                  <div class="container" style="width: 50%;">

                                    <% const store = storeProfile.username %>
                                    <% let Segment %>
                                    <% if (segment) { %> <!-- esto es un objeto que viene del backend -->
                                      <%  Segment = segment %>   
                                    <% } else { %>
                                      <%  Segment = "null" %> 
                                    <% } %>  
                                                                          
                                  
                                      <form  method="get" class="d-flex" id="formSearch">
                                        <input type="hidden" value="<%= store %>" id="storeSearch">
                                        <input type="hidden" value="<%= Segment %>" id="segmentSearch">
                                        <input class="form-control me-2" type="text" id="elementSearch" placeholder="Puedes buscar cualquier articulo de esta tienda" aria-label="Search">
                                        <button class="btn"  id="submitSearch" style="color:<%= storeProfile.bGColorText %>; border : 1px solid <%= storeProfile.bGColorText %>">Search</button>
                                      </form>
                                     

                                  </div>
                              </div>
                          
                          </div>
                          <% }; %>

                          <a href="#workSpace" class="anclaWorspace text-dark">
                            <div class="nailUpp px-3 mb-2" style="background-color:<%= storeProfile.bGColorTopbar%>;color:<%= storeProfile.bGColorText %>;">
                              <i class="bi bi-chevron-down Heading"></i>
                            </div>  
                          </a>

  <!--                             //prueba de popover                                                                                                
                          <button type="button" class="btn btn-secondary" data-bs-toggle="popover" title="Título del Popover" data-bs-placement="left" data-bs-content="Left Contenido del popover aquí.">
                            Hover o click aquí
                          </button>

                          <button type="button" class="btn btn-secondary" data-bs-toggle="popover"  data-bs-placement="left" data-bs-content="Left Contenido del popover aquí sin titulo.">
                            Hover o click aquí
                          </button>
  -->
                        <div class="containerScoreTrustMain" style="position: fixed; right: 0; top: 120px; z-index : 1">

                          
                            <div class="nail border d-flex justify-content-center align-items-center cursor-pointer"  style="margin-bottom: 8px; width: 40px; height: 40px; border-radius: 50%; background-color: rgb(34, 34, 34)">
                              <i class="bi bi-arrows-expand text-light" style="font-size: 1rem;"></i>
                            </div>
                            <div class="contentEfec mb-3" style="position: relative;">

                              <div class="contentExpan">
                                <div class="containerScoreTrust d-flex justify-content-center align-items-center flex-column"  
                                  style="position: absolute; top: 0; width: 55px; height: 0px; border-top-left-radius: 0px; border-bottom-left-radius: 5px;">
                                    <div class="contenForEfect closed" style="width: 100%; height: 100%;">
                                      <div class="containerScore border d-flex flex-column justify-content-center align-items-center p-1 no-select" style="background-color: #fcfcfc; height: 40%; width: 100%;" data-bs-toggle="modal" data-bs-target="#staticLevelSell">
                                        <p class="level m-0" style="font-size: 11px;"></p>
                                        <div class="imgLevel"></div>
                                        <p class="scoreLevel m-0"></p>
                                      </div>
                                      <div class="containerTrust border closed d-flex flex-column justify-content-center align-items-center no-select" style="background-color: #fcfcfc; height: 40%; width: 100%;" data-bs-toggle="modal" data-bs-target="#staticTrustSell">
                                        <p class="m-0" style="font-size: 11px;">Trust</p> 
                                        <i class="bi bi-shield-check my-2" style="font-size: 1rem;"></i>
                                        <p class="trustLevel m-0"></p>
                                      </div>
                                    

                                  <% if (user) { %>
                                    
                                        <% if (user.username == Account[0].username) { %> <!-- el usuario logeado es el mismo dueño de la tienda -->

                                          <!-- <div class="containRate border-top d-flex flex-column align-items-center justify-content-center" style="background-color:  rgb(167, 167, 167); height: 20%; width: 100%; border-bottom-left-radius: 50%; border-bottom-right-radius: 50%;"> -->
                                          <div class="containRate border d-flex flex-column align-items-center justify-content-center bg-warning" style="height: 20%; width: 100%; border-bottom-left-radius: 50%; border-bottom-right-radius: 50%;">
                                            <button class="popover" type="button" style="background-color: transparent; border: none ;" data-bs-toggle="popover"  data-bs-placement="left" data-bs-content="Los propietarios no pueden calificar sus tiendas.">  
                                              <i class="bi bi-star" style="font-size: 1rem;"></i>
                                            </button>   
                                          </div> 

                                        <% } else { %> <!-- no es el dueño de la tienda -->

                                              <% if (boxPublisher.length !==0) { %>  <!-- no es el propietario y la tienda tiene al menos un articulo -->
                                                <div class="containRate border d-flex flex-column align-items-center justify-content-center cursor-pointer bg-warning " style="height: 20%; width: 100%; border-bottom-left-radius: 50%; border-bottom-right-radius: 50%;"  data-bs-toggle="modal" data-bs-target="#staticOption">
                                                  <i class="bi bi-star-fill" style="font-size: 1rem;"></i>
                                                </div>


                                              <% } else { %> <!-- no es el propietario y la tienda no tiene articulos es una tienda vacia -->
                                               
                                                    <div class="containRate border d-flex flex-column align-items-center justify-content-center bg-warning" style="height: 20%; width: 100%; border-bottom-left-radius: 50%; border-bottom-right-radius: 50%;">
                                                      <button class="popover" type="button" style="background-color: transparent; border: none ;" data-bs-toggle="popover"  data-bs-placement="left" data-bs-content="Las cuentas sin productos o servicios no serán calificadas en Blissenet, ya que no se consideran tiendas.">
                                                        <div class="contentStart d-flex justify-content-center align-items-center rounded-pill shadow-sm"  style="width: 30px; height: 30px; ">
                                                          <i class="bi bi-star" style="font-size: 1rem;"></i>
                                                        </div>
                                                      </button>  
                                                    </div>
  
                                              <% }; %>

                                        <% }; %>  
                                        
                                  <% } else { %>
                                    <!-- el usuaio entra sin haberse logeado  -->
                                    <div class="containRate border d-flex flex-column align-items-center justify-content-center bg-warning" style="height: 20%; width: 100%; border-bottom-left-radius: 50%; border-bottom-right-radius: 50%;">
                                      <button class="popover" type="button" style="background-color: transparent; border: none ;" data-bs-toggle="popover"  data-bs-placement="left" data-bs-content="Debes estar logeado para poder calificar.">    
                                        <i class="bi bi-star" style="font-size: 1rem;"></i>
                                      </button>   
                                    </div> 

                                  <% }; %>  

                                
                                  </div>
                                </div>
                              </div>  
                            </div>


                            <div class="containerAdminMain d-flex flex-column justify-content-center align-items-center" style="margin-right: 13px; z-index : 1">

                              <button class="popover" type="button" style="background-color: transparent; border: none ;" data-bs-toggle="popover"  data-bs-placement="left" data-bs-content="Carrito de compras en desarrollo.">
                                <div class="contentCardBuy border border-dark rounded-pill my-2" style="width: 40px; height: 40px;">
                                  <img src="/img/iconCardBuy.png" alt="" class="rounded-pill" style="width: 40px; height: 40px;">
                                </div>
                              </button>  


                              <button style="background-color: transparent; border: none;" data-bs-toggle="popover"  data-bs-placement="left" data-bs-content="ChatdeBliss en desarrollo.">
                                <div class="contentChatMessage border border-dark rounded-pill my-2" style="width: 40px; height: 40px;">
                                  <img src="/img/iconChatMessage.png" alt="" class="rounded-pill" style="width: 40px; height: 40px;">
                                </div>
                              </button>  

                              <% if (user) { %>
                                    <!-- si existe un usuario -->
                                <% if (user.username == Account[0].username) { %>
                                    <!-- y es el propietario de la tienda podra ver esta opcion -->
                                  <div class="contentAdmin border border-dark rounded-pill my-2" style="width: 40px; height: 40px;">
                                    <a href="/admin-store"><img src="/img/iconAdmin.png" alt="" class="rounded-pill" style="width: 40px; height: 40px;">
                                    </a> 
                                  </div>

                                <% } %>

                              <% } %>  

                            </div> 


                        </div>

                        
                                                  
                        <div class="Workspace" style="width: 96%;">

                              <% if (newBox.length !==0) {%>
                                <div class="containerCard d-flex flex-wrap justify-content-start p-3" style="width: 100%;">

                                  <% newBox.forEach( (ele, i)=>{ %>

                                    <div class="card m-2 p-0 shadow cardPublished">

                                      <div class="card-body d-flex flex-column p-0">

                                          <div class="containerBackground m-0" style="position: relative; background-image : url('<%= ele.images[0].url%>'); background-size: cover;">
                                            <div class="containerFilter" style="width: 100%; height: 100%;  backdrop-filter: blur(10px) ; position: absolute; top: 0;"></div>

                                              <div id="carouselExampleControls<%= i %>" class="carousel slide" data-bs-ride="carousel"
                                                data-bs-interval="false" data-bs-touch="true" style="position: relative; z-index: 1;" >

                                                <!-- esto es el icono para acceder a las herramientas de offer, bestProduct, onlyOneAvailable & Delivery -->
                                                <% if (user) { %>

                                                    <% if (user.username === storeProfile.username) { %>
                                                          
                                                      <% if (ele.department !== 'raffle' ){ %>

                                                            <div class="dropdown d-flex justify-content-start" style="position: absolute; top: 10px; z-index: 100; width: 100%;">
                                                              <i class="bi bi-three-dots-vertical mx-2 p-1 rounded-pill d-flex justify-content-center setting" data-bs-toggle="dropdown"></i>
                                                                                                    
                                                              <ul class="dropdown-menu float-sm-start" aria-labelledby="dropdownMenu2" style="background-color: rgba(255, 255, 255, 0.9)">
                                                                <li> <button class="offer dropdown-item">Oferta <input type="hidden" value="<%= ele.department %>"> <input type="hidden" value="<%= ele._id %>"> </button> </li>
                                                                <li> <button class="bestProduct dropdown-item">Mejor Producto <input type="hidden" value="<%= ele.department %>"> <input type="hidden" value="<%= ele._id %>"></button></li>
                                                                <li> <button class="onlyOneAvailable dropdown-item" type="button">Unico Disponible <input type="hidden" value="<%= ele.department %>"> <input type="hidden" value="<%= ele._id %>"> </button></li>
                                                                <% if (ele.department === 'arts' || ele.department === 'items' ){ %>
                                                                  <li> <button class="delivery dropdown-item">Delivery <input type="hidden" value="<%= ele.department %>"> <input type="hidden" value="<%= ele._id %>"></button></li>
                                                                <%  } else { %>
                                                                  <li class="invisible"> <button class="delivery dropdown-item">Delivery <input type="hidden" value="<%= ele.department %>"> <input type="hidden" value="<%= ele._id %>"></button></li>
                                                                <% } %>  
                                                              </ul>
                                                            </div>

                                                      <% }; %>
                                                          
                                                    <% }; %>
                                  
                                                <% }; %>
                                              
                                                
                                                <div class="carousel-inner" style="width: 100%; height: 220px;  z-index: 1;">
                                                  <div class="carousel-item active">
                                                    <a href="/product/<%= ele.department %>/<%= ele._id %>"> 
                                                      <img src="<%= ele.images[0].url%>" class="imgFront" alt="...">
                                                    </a>
                                                  </div>
                                                  <% for (let x=1; x < ele.images.length; x++) { %>
                                                    <% const element=ele.images[x] %>
                                                      <div class="carousel-item">
                                                        <a href="/product/<%= ele.department %>/<%= ele._id %>"> <img src="<%= element.url %>" class="d-block w-100"
                                                          style="  width: 100%; height: 100%; object-fit: cover;">
                                                        </a>
                                                      </div>

                                                  <% }; %>
                                                </div>

                                                <button class="carousel-control-prev" type="button"
                                                  data-bs-target="#carouselExampleControls<%= i %>" data-bs-slide="prev">
                                                  <span class="carousel-control-prev-icon"></span>
                                                  <span class="visually-hidden">Previous</span>
                                                </button>
                                                <button class="carousel-control-next" type="button"
                                                  data-bs-target="#carouselExampleControls<%= i %>" data-bs-slide="next">
                                                  <span class="carousel-control-next-icon"></span>
                                                  <span class="visually-hidden">Next</span>
                                                </button>
                                              </div>
                                  
                                          </div>

                                          <hr class="m-0">

                                          <!-- esta parte va a cambiar cuando sea oferta -->
                                          <% if (ele.department !== 'raffle') { %>
                                            <% if (ele.offer === false) { %>
                                            <div class="boxDetail" style="height: 120px; position: relative; background-color: #ffffff;">
                                                    <div class="containerDetails mx-2 " style="margin-bottom: 10px; margin-top: 10px;">
                  
                                                        <div class="containerTitleFavorite d-flex justify-content-between">
                                                          <a href="/product/<%= ele.department %>/<%= ele._id %>" class="text-dark lh-sm"
                                                            style="text-decoration: none;">
                                                            <%= ele.title %>
                                                          </a>                                            
                                                        
                                                          <i class="bi bi-heart ps-2 linkHeart" style="cursor: pointer;"><input type="hidden" value="<%= ele.department %>"><input type="hidden" value="<%= ele._id %>"></i>                                         
                                                        </div>
                    
                                                        <p class="m-0 badge bg-secondary text-light"><a href="/account/<%= ele.username %>" class="text-light text-decoration-none"><%= ele.username %></a> </p>
                                                        
                                                        <div class="containerPriceIcon " style="width: 100%; position: absolute; bottom: 10px; left: 0px;">
                  
                                                          <div class="containerPrice d-flex justify-content-between px-2">
                                                            <p class="m-0 px-1 border border-dark rounded-pill">$ <%= ele.price %>
                                                            </p>
                                                            <div class="containerTresIconos d-flex">
                                                              
                                                              <div class="containerDelivery">
                                                                <% if (ele.delivery === true) {%>
                                                                  <i class="bi bi-truck me-1"></i>
                                                                <% }; %>  
                                                              </div>     
                                                              <div class="containerOnlyOneAvailable">
                                                                <% if (ele.onlyOneAvailable === true) {%>
                                                                  <i class="bi bi-1-square-fill me-1"></i>
                                                                <% }; %>  
                                                              </div>
                                                              <div class="containBestProduct">
                                                                <% if (ele.bestProduct === true) {%>
                                                                  <i class="bi bi-award"></i>
                                                                <% }; %>  
                                                              </div>
                                                            </div>
                                                          </div>
                  
                                                        </div>
                                                        
                    
                                                    </div>
                                            </div>
                                            <% } else { %>
                                            <div class="boxDetail" style="height: 120px; position: relative; background-color: #fcda57;">
                                                        <div class="containerDetails mx-2 " style="margin-bottom: 10px; margin-top: 10px;">
                    
                                                          <div class="containerTitleFavorite d-flex justify-content-between">
                                                            <a href="/product/<%= ele.department %>/<%= ele._id %>" class="text-dark lh-sm"
                                                              style="text-decoration: none;">
                                                              <%= ele.title %>
                                                            </a>                                            
                                                          
                                                            <i class="bi bi-heart ps-2 linkHeart" style="cursor: pointer;"><input type="hidden" value="<%= ele.department %>"><input type="hidden" value="<%= ele._id %>"></i>                                         
                                                          </div>
                  
                                                          <p class="m-0 badge bg-secondary text-light"><a href="/account/<%= ele.username %>" class="text-light text-decoration-none"><%= ele.username %></a> </p>
                                                              
                                                          <div class="containerPriceIcon" style="width: 100%; position: absolute; bottom: 10px; left: 0px;">
                    
                                                            <div class="containerPrice d-flex justify-content-between px-2">
                                                              <p class="m-0 px-1 border border-dark rounded-pill">
                                                                $ <%= ele.price %>
                                                              </p>
                                                              <div class="containerTresIconos d-flex">

                                                                <div class="containerDelivery">
                                                                  <% if (ele.delivery === true) {%>
                                                                    <i class="bi bi-truck me-1"></i>
                                                                  <% }; %>  
                                                                </div>
                                                                <div class="containerOnlyOneAvailable">
                                                                  <% if (ele.onlyOneAvailable === true) {%>
                                                                    <i class="bi bi-1-square-fill me-1"></i>
                                                                  <% }; %>  
                                                                </div>
                                                                <div class="containBestProduct">
                                                                  <% if (ele.bestProduct === true) {%>
                                                                    <i class="bi bi-award"></i>
                                                                  <% }; %>  
                                                                </div>
                                                              </div>
                                                            </div>
                    
                                                          </div>
                                                          
                                                        </div>
                                            </div>  
                                            <% }; %>
                                          <% } else { %>
                                            <div class="boxDetail" style="height: 120px; position: relative; background-color: #ffffff;">
                                              <div class="containerDetails mx-2 " style="margin-bottom: 10px; margin-top: 10px;">
            
                                                  <div class="containerTitleFavorite d-flex justify-content-between">
                                                    <a href="/product/<%= ele.department %>/<%= ele._id %>" class="text-dark lh-sm"
                                                      style="text-decoration: none;">
                                                      <%= ele.title %>
                                                    </a>                                            
                                                  
                                                    <i class="bi bi-heart ps-2 linkHeart" style="cursor: pointer;"><input type="hidden" value="<%= ele.department %>"><input type="hidden" value="<%= ele._id %>"></i>                                         
                                                  </div>
              
                                                  <p class="m-0 badge bg-secondary text-light"><a href="/account/<%= ele.username %>" class="text-light text-decoration-none"><%= ele.username %></a> </p>
                                                        
                                                  <div class="containerPriceIcon" style="width: 100%; position: absolute; bottom: 10px; left: 0px;">
                    
                                                    <div class="containerPrice d-flex justify-content-between px-2">
                                                      <p class="m-0 px-1 border border-dark rounded-pill">
                                                        $ <%= ele.price %>
                                                      </p>
                                                      <div class="containerTickets">
                                                        <div class="containerIconCategory">
                                                          <% if (ele.category == 'Gratis' ) {%>
                                                          <span class="rounded-1 p-0 d-flex justify-content-center align-items-center me-1" style="width: 25px; background-color: #131313;">
                                                            <i class="bi bi-ticket-fill" style="color: rgb(17, 235, 235);"></i>
                                                          </span>
                                                          <% } else { %>
                                                          <span class="rounded-1 p-0 d-flex justify-content-center align-items-center me-1" style="width: 25px; background-color: #131313;">
                                                            <i class="bi bi-ticket-fill" style="color: brown;"></i>
                                                          </span>
                                                          <% }; %>  
                                                        </div>
                                                      </div>
                                                    </div>
            
                                                  </div>
                                                
                                              </div>
                                            </div>
                                          <% }; %>  

                                      </div>

                                    </div>

                                  <% }); %>

                                </div>

                                <div class="paginate d-flex justify-content-center align-items-center mt-2" style="position: relative; z-index : 120 !important">
                                  <nav aria-label="...">
                                    <ul class="pagination  m-0">
                                      <% if (paginate) { %>
          
                                        <% if ( paginate.pagina == 1 ) { %>
                                        <li class="page-item disabled">
                                          <a class="page-link" href="?paginate=first"> <i class="bi bi-arrow-bar-left"></i> 1</a>
                                        </li>
                                        <% } else { %>
                                          <li class="page-item">
                                            <a class="page-link" href="?paginate=first"> <i class="bi bi-arrow-bar-left"></i> 1</a>
                                          </li>  
                                        <% }; %>  
          
                                        <% if ( paginate.pagina == 1 ) { %>
                                        <li class="page-item prev disabled">
                                          <a class="page-link" href="?paginate=prev"> Prev</a>
                                        </li>
                                        <% } else { %>
                                        <li class="page-item prev">
                                          <a class="page-link" href="?paginate=prev"> Prev </a>
                                        </li>  
                                        <% }; %>
                                        <li class="page-item active">
                                          <span class="page-link pagina"><%= paginate.pagina %></span>
                                        </li>
                                        <% if ( paginate.pagina == paginate.totalPagina ) { %>
                                        <li class="page-item next disabled">
                                          <a class="page-link" href="?paginate=next"> Next</i></a>
                                        </li>
                                        <% } else { %>
                                        <li class="page-item next">
                                          <a class="page-link" href="?paginate=next"> Next</i> </a>
                                        </li>  
                                        <% }; %>
          
                                        <% if ( paginate.pagina == paginate.totalPagina ) { %>
                                        <li class="page-item disabled">
                                          <a class="page-link" href="?paginate=last"> <%= paginate.totalPagina %> <i class="bi bi-arrow-bar-right"></i></a>
                                        </li>
                                        <% } else { %>
                                        <li class="page-item">
                                          <a class="page-link" href="?paginate=last"> <%= paginate.totalPagina %> <i class="bi bi-arrow-bar-right"></i></a>
                                        </li>  
                                        <% }; %>  
          
                                      <% }; %>
                                    </ul>
                                  </nav>
                                </div>
                              <% } else { %>

                                <div class="ContainerMessage d-flex justify-content-center p-2" style="background-color: rgba(219, 223, 228, 0); width: 100%; margin-top: 80px; margin-bottom: 80px;">
                              
                                        <div class="containerImg border border-warning rounded-pill p-3" style="background-color:<%= storeProfile.bGColorTopbar%>; width: 140px; height: 140px;">
                                          <img src="/img/Lupa_sinResultados.png" alt="lupa" class="lupaSinRespuesta"  style="width: 140px; height: 140px;">
                                        </div>  
                              
                                </div>

                              <% }; %>
                              
                        </div>

                    </div>
                  </div> 
                  
                  <div class="containerViewRatesStore closed border" style="background-color: white;">
                    <div class="containert">
                      <div class="modal-header" style="background-color: white;">
                        <h6 class="modal-title">Ver Calificaciones y Opiniones</h6>
                        <i class="bi bi-x-lg cursor-pointer" id= "btnXCloseViewRate"></i>
                      </div>
                      
                      <div class="row m-0 bodyAnalisi d-flex justify-content-between">

                        <div class="col-xl-3 col-lg-3 col-md-5 col-sm-6 p-0 containerPoint d-flex flex-column justify-content-center align-items-center px-2">
                            
                            <p class="pountrateView p-0 mb-1" style="font-size: 40px;"> <!-- 4.8 --> </p>
                            <div class="boxstarView"> <!-- ***** --> </div>
                            <p class="countrateView"> <!-- 56 --> </p>

                        </div>

                        <div class="col-xl-9 col-lg-9 col-md-6 col-sm-6 p-0 containerRatePercentBar px-3">
                                                                  
                              <div class="contentBar d-flex my-1" style="height: 25px;">

                                <span class="p-0 ms-2" style="width: 10%;"> <small class="m-0"> 5 <i class="bi bi-star-fill p-0 m-0"></i> </small>  </span>
                                <div class="progress py-1 mt-1" id="barStar5" style="width: 90%;">
                                  <!-- dinamico -->
                                </div>

                              </div>

                              <div class="contentBar d-flex my-1" style="height: 25px;">

                                <span class="p-0 ms-2" style="width: 10%; height: 100%;"> <small class="m-0"> 4 <i class="bi bi-star-fill p-0 m-0"></i> </small>  </span>
                                <div class="progress py-1 mt-1" id="barStar4" style="width: 90%;">
                                  <!-- dinamico -->
                                </div>

                              </div>

                              <div class="contentBar d-flex my-1" style="height: 25px;">

                                <span class="p-0 ms-2" style="width: 10%; height: 100%;"> <small class="m-0"> 3 <i class="bi bi-star-fill p-0 m-0"></i> </small>  </span>
                                <div class="progress py-1 mt-1" id="barStar3" style="width: 90%;">
                                  <!-- dinamico -->
                                </div>

                              </div>

                              <div class="contentBar d-flex my-1" style="height: 25px;">

                                <span class="p-0 ms-2" style="width: 10%; height: 100%;"> <small class="m-0"> 2 <i class="bi bi-star-fill p-0 m-0"></i> </small>  </span>
                                <div class="progress py-1 mt-1" id="barStar2" style="width: 90%;">
                                  <!-- dinamico -->
                                </div>

                              </div>

                              <div class="contentBar d-flex my-1" style="height: 25px;">

                                <span class="p-0 ms-2" style="width: 10%; height: 100%;"> <small class="m-0"> 1 <i class="bi bi-star-fill p-0 m-0"></i> </small>  </span>
                                <div class="progress py-1 mt-1" id="barStar1" style="width: 90%;">
                                  <!-- dinamico -->
                                </div>

                              </div>
                            
                        </div>
                        
                      </div>
                      <div class="row m-0 my-3">
                        <div class="col-12 d-flex py-2" style="overflow-x: auto;">
                            <button class="btn btn-secondary rounded-pill px-2 py-1 mx-2 d-flex justify-content-center align-items-center btnRateAll" style="width: 90px; height: 40px;"> <span class="d-flex mx-1">Todos <i class="bi bi-star ms-1"></i> </span> </button>
                            <button class="btn btn-secondary rounded-pill px-2 py-1 mx-2 d-flex justify-content-center align-items-center btnRate5" style="width: 90px; height: 40px;"> <span class="d-flex mx-1">5 <i class="bi bi-star ms-1"></i> </span> </button>
                            <button class="btn btn-secondary rounded-pill px-2 py-1 mx-2 d-flex justify-content-center align-items-center btnRate4" style="width: 90px; height: 40px;"> <span class="d-flex mx-1">4 <i class="bi bi-star ms-1"></i> </span> </button>
                            <button class="btn btn-secondary rounded-pill px-2 py-1 mx-2 d-flex justify-content-center align-items-center btnRate3" style="width: 90px; height: 40px;"> <span class="d-flex mx-1">3 <i class="bi bi-star ms-1"></i> </span> </button>
                            <button class="btn btn-secondary rounded-pill px-2 py-1 mx-2 d-flex justify-content-center align-items-center btnRate2" style="width: 90px; height: 40px;"> <span class="d-flex mx-1">2 <i class="bi bi-star ms-1"></i> </span> </button>
                            <button class="btn btn-secondary rounded-pill px-2 py-1 mx-2 d-flex justify-content-center align-items-center btnRate1" style="width: 90px; height: 40px;"> <span class="d-flex mx-1">1 <i class="bi bi-star ms-1"></i> </span> </button>
                        </div>
                      </div>

                      <div class="bodyRates p-3" id="bodyRates" style="min-height: max-content; max-height: 80vh; overflow-y: auto;">
                        <!-- dinamico -->
                      </div>
                      

                      <div class="bodyFooter d-flex justify-content-end my-2">
                          <button type="button" class="btn btn-success btnCloseViewRate m-2">Cerrar Calificaciones</button>
                      </div>
                    </div>
                  </div>
                  
                  <!-- cierre de storeProfile -->   
                  
              </div>
              <div class="col-sm-12 col-md-12 col-lg-12 col-xl-12 px-0 ">
                <div class="contetAntFooter" style="height: 40px; background-color:<%= storeProfile.bGColorWorkspace %>">
                   <!-- aqui ira el contenedor del marketing space --> 
                </div>
                <div class="containerDetailsMessajesRRSS pt-3" style="height: auto; background-color:<%= storeProfile.bGColorTopbar%>;">
                    <% if (storeProfile) { %>
                    
                        <div class="containerMessager d-flex justify-content-start">

                          <p class="MessagerStore mb-0 mx-5" style="font-size: 18px; color: <%= storeProfile.bGColorText %>">
                            <i>
                              <%= storeProfile.profileMessage %>
                            </i>
                          </p>
                    
                        </div>
                        <div class="containerMainRRSS d-flex justify-content-end mx-5">
                         
                          <div class="containerRRSS" style="height: 30px; width: 100%">
                                                         
                        
                            <div class="facebook mx-2">
                                <% if (storeProfile.facebook) { %>
                                  <a href="https://www.facebook.com/<%= storeProfile.facebook %>" target="_blank" style="color:<%= storeProfile.bGColorText %>"><i class="bi bi-facebook"></i></a>
                                <% } %>
                            </div>
                            <div class="instagram mx-2">
                              <% if (storeProfile.instagram) { %>
                                <a href="https://www.instagram.com/<%= storeProfile.instagram %>" target="_blank" style="color:<%= storeProfile.bGColorText %>"><i class="bi bi-instagram"></i></a>
                              <% } %>
                            </div>
                            <div class="youtube mx-2">
                              <% if (storeProfile.youtube) { %>
                                <a href="https://www.youtube.com/<%= storeProfile.youtube %>" target="_blank" style="color:<%= storeProfile.bGColorText %>"><i class="bi bi-youtube"></i></a>
                              <% } %>
                            </div>
                            <div class="tiktok mx-2">
                              <% if (storeProfile.tiktok) { %>
                                <a href="https://www.tiktok.com/<%= storeProfile.tiktok %>" target="_blank" style="color:<%= storeProfile.bGColorText %>"><i class="bi bi-tiktok"></i></a>
                              <% } %>
                            </div>

                                                    

                          </div>

                        </div>
                      
                    <% }; %>
                </div> 
                
                <footer class="py-4" style="height: auto; background-color:<%= storeProfile.bGColorTopbar%>;color:<%= storeProfile.bGColorText %>;">
                  
                  <div class="row mx-0 contentClient d-flex justify-content-around align-items-center">
                    <div class="col-sm-6 col-md-6 col-lg-3 px-0 contentUserImg d-flex justify-content-center align-items-center my-2">
                        <div class="containerImg mx-2">
                          <% if (storeProfile.avatarPerfil[0].url.length === 0 ) {%>
                            <td> <img src="https://www.gravatar.com/avatar/<%= storeProfile.mailhash %>?d=identicon" class="rounded-3" style="width: 50px;"></td>   
                            <% } else {%>
                            <td><img src="<%= storeProfile.avatarPerfil[0].url %>" alt="" class="rounded-3" style="width: 50px;"></td>
                          <% }; %>
                        </div>
                        <div class="containerDetail my-2">
                          <p class="mb-0" style="color:<%= storeProfile.bGColorText %>"> <%= storeProfile.username%></p>
                          <p class="mb-0"> <span class="from"></span> </p>
                        </div>

                    </div>     
                    <div class="col-sm-6 col-md-6 col-lg-3 px-0 contentUserDetails d-flex justify-content-around align-items-center">
                      <div class="containerRate d-flex flex-column mx-2">
                        <span id="pountCalif"> <!-- Dinamic --> </span> 
                        <span id="pountCount"> <!-- Dinamico --> </span>
                      </div>

                    </div> 
                    <div class="col-sm-6 col-md-6 col-lg-3 px-0 contentUserImgDetails d-flex justify-content-around align-items-center">
                        <div class="containerYears my-2 d-flex flex-column align-items-center">
                          <p class="m-0" style="color:<%= storeProfile.bGColorText %>"><small><%= storeProfile.company %></small></p>
                          <p class="m-0" style="color:<%= storeProfile.bGColorText %>"><small><%= storeProfile.companyRif %></small></p>
                          <p class="m-0" style="color:<%= storeProfile.bGColorText %>"><span class="yearRegister"></span> - <span class="yearCurrent"></span></p>
                        </div>
                    </div>    
                    <div class="col-sm-6 col-md-6 col-lg-3 px-0 contentUserImgDetails d-flex justify-content-around align-items-center">
                        <div class="containerYears my-2 rounded-3 d-flex flex-column align-items-center">
                          <p class="m-0" style="color:<%= storeProfile.bGColorText %>"><i class="bi bi-geo-alt me-1"></i> <small><%= storeProfile.states %></small></p>
                          <p class="m-0" style="color:<%= storeProfile.bGColorText %>"><i class="bi bi-geo me-1"></i> <small><%= storeProfile.cities %></small></p>
                        </div>
                    </div>   
                  </div>
                  <div class="row mx-0 contentBlisnet d-flex justify-content-center align-items-center mt-3">
                    <div class="col-sm-12 col-md-12 col-lg-12 px-0 contentPlatform border-start border-dark d-flex justify-content-center align-items-center">
                      <div class="containerBlisnetRedes my-2 rounded-3 d-flex flex-column align-items-center">
  
                        <p class="m-0"  style="color:<%= storeProfile.bGColorText %>;"  id="logoBlissenet_com" </p>
                        <div class="contentRedes d-flex">
                          <span class="itemOption"><a href="https://www.instagram.com/blissenetcom/"  style="color :<%= storeProfile.bGColorText %>"><i class="bi bi-instagram  me-3"></i></a></span>
                          <span class="itemOption"><a href="https://www.facebook.com/search/top?q=blissenetcom"  style="color :<%= storeProfile.bGColorText %>"><i class="bi bi-facebook me-3"></i></a></span>
                          <span class="itemOption"><a href="https://x.com/blissenetcom/"  style="color :<%= storeProfile.bGColorText %>"><i class="bi bi-twitter-x  me-3"></i></a></span>
                        </div>
                       
                      </div>
                    </div>
                  </div>

                 

                </footer>
              </div>
              
          </div>
      <% }; %>

  </main>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js" integrity="sha512-pUhApVQtLbnpLtJn6DuzDD5o2xtmLJnJ7oBoMsBnzOkVkpqofGLGPaBJ6ayD2zQe3lCgCibhJBi4cj5wAxwVKA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <%- include('../partials/scripts.ejs') %>
  <%- include('../partials/scriptsOnlyNavi-simpleNoIcons.ejs') %>


  <script>
    const bGColorText = document.getElementById('bGColorText');
    const bGColorTopbar = document.getElementById('bGColorTopbar');
    const btnFollow = document.getElementById('btnFollow');
    const spanBtnFollow = document.getElementById('spanBtnFollow');

    const contentConfetyFollow = document.querySelector('.contentConfetyFollow');
    const buttonFollow = document.querySelector('.buttonFollow');
    const user = document.getElementById('iDLogeado'); 
    const userTienda = document.getElementById('iDStore'); 

    btnFollow.addEventListener("click", ()=>{
      const BGColorTopbar = bGColorTopbar.value; const BGColorText = bGColorText.value;
      console.log(`BGColorTopbar ${BGColorTopbar} | BGColorText ${BGColorText}`) //colores cutomizados por el usuario de la tienda esto va solo en seguir
      const User = user.value; const UserTienda = userTienda.value;
      efectSoundExpan.currentTime = 0; //Reiniciamos el sonido
      efectSoundExpan.play().catch(error => {
                console.error("Error al reproducir el sonido:", error);
            });
      
      
      
        const datos = {
            user : User,
            userOfStore : UserTienda
        };
          
               
        fetch('/account/followStore', {

          method: "post",
          body: JSON.stringify(datos),
          headers: {"content-type" : "application/json"}

          })
          .then(response =>response.json() )
          .then( jsonx =>{
            

            console.log("ver aqui lo que llega despues de seguir a alguien ---->", jsonx)
            const type = jsonx.type;
            const note = jsonx.note; 
            // { "type" : "Following", "note" : "Tienda guardada y siguiendo" });
            // type puede ser Following, Error o stopFollowing 
            if (type === "Following"){
              //Seguir
              setTimeout(() => {
                contentConfetyFollow.innerHTML = "";
              }, 1900);
              
              console.log("empiezo a seguirla, cambiar el boton a Siguiendo");
              console.log("note ->", note);
              contentConfetyFollow.innerHTML = `<img src="/img/gif-1.gif" alt="" style = "width: 180px; height: 90px;">`;
              spanBtnFollow.innerText = "";
              spanBtnFollow.innerText = "Siguiendo";
              buttonFollow.style.cssText = "background-color : #131313; color : #ffffff; border: 1px solid #ffffff";

       

            } else if (type === "stopFollowing") {
              //Siguiendo
              console.log("deje de seguirla, cambiar al boton Seguir. ")
              console.log("note ->", note);
              spanBtnFollow.innerText = "";
              spanBtnFollow.innerText = "Seguir";
              buttonFollow.style.cssText = `background-color : ${BGColorTopbar}; color : ${BGColorText}; border : 1px solid ${BGColorText}`;
  
         
            } else {
              console.log("Ha ocurrido un error");
              console.log("note ->", note);
            }

            
          })
          .catch( err => console.log(err));




    });

    
  </script>

  <script>
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]'))
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
      return new bootstrap.Popover(tooltipTriggerEl)
    })
  </script>



<script>
  const formSegment = document.getElementById('formSegment');
  const floatingSelect = document.getElementById('floatingSelect');
  const store_indexed = document.getElementById('store_indexed');
  const store_username = document.getElementById('store_username');

  floatingSelect.addEventListener('change', ()=>{
    
    const segment = floatingSelect.value;
    const storeIndexed = store_indexed.value;
    const storeUsername = store_username.value;
    console.log("segment -->", segment);
    console.log("storeIndexed -->", storeIndexed);
    //aqui se forma el url donde se va a mandar
    formSegment.action=`/account/${storeUsername}/${segment}`;
    console.log("formSegment -->", formSegment);
    formSegment.submit();
      
  })

</script>

<script>
  const formSearch = document.getElementById('formSearch');
  const storeSearch = document.getElementById('storeSearch');
  const segmentSearch = document.getElementById('segmentSearch');
  const elementSearch = document.getElementById('elementSearch');
  const submitSearch = document.getElementById('submitSearch');
  let element; //se usa abajo puede tener dos valores vacio o con alguna informacion
  //si es vacio ira con un string "null", esto es porque en el url debe viajar algo siempre sino
  //no conocera la direccion donde va.

  formSearch.addEventListener('submit', function(event) {
    event.preventDefault(); // Evita que el formulario se envíe automáticamente
    // Aquí puedes ejecutar tu lógica o enviar el formulario manualmente
    console.log('Formulario enviado manualmente');
    // Si deseas enviar el formulario, puedes hacerlo aquí
  });

  submitSearch.addEventListener('click', function() {
    // Aquí puedes decidir cuándo enviar el formulario
    console.log("Datos obtenidos del buscador para enviar al backend");
    
    const store = storeSearch.value;
    const segment = segmentSearch.value;
    element = elementSearch.value;

    if (element === "" ){
      element = "null";
    } 
    
    console.log("store --->", store);
    console.log("segment --->", segment);
    console.log("element --->", element);
    
    formSearch
     //aqui se forma el url donde se va a mandar
     //action="/account/search/store/Segment/search"
    formSearch.action=`/account/search/${store}/${segment}/${element}`;
    console.log("formSegment -->", formSegment);
    formSearch.submit();
  });

  
  
</script>

<script>
  const nail = document.querySelector('.nail');
  const contentExpan = document.querySelector('.contentExpan');
  const containerScoreTrust = document.querySelector('.containerScoreTrust');
  const contenForEfect = document.querySelector('.contenForEfect');
  const containerAdminMain = document.querySelector('.containerAdminMain');

  const efectSoundExpan = document.getElementById('efectSoundExpan');
  

//clientHeight`: te da la altura del elemento, incluyendo el padding, pero sin los bordes ni el margen.
//`offsetHeight`: te da la altura total del elemento, incluyendo el padding y los bordes.
  
                          

  nail.addEventListener('click', ()=>{
    const altura = containerScoreTrust.clientHeight; 
    //console.log('La altura del containerScoreTrust :', altura);

    if (altura == 0){ //esta en forma redonda y se pondra rectangular pero debe hacerlo con transicion.
      //contentExpan.classList.remove('closed');
      efectSoundExpan.currentTime = 0; //Reiniciamos el sonido
      efectSoundExpan.play().catch(error => {
                console.error("Error al reproducir el sonido:", error);
            });

      //console.log("altura es cero", altura);
      nail.style.cssText = 'transition: 1s ease all; margin-bottom: 0; width: 55px; height: 30px; background-color: rgba(29, 29, 29, 1)'
      containerScoreTrust.style.cssText = 'transition: 1.5s ease height; width: 55px; height: 230px; border-top-left-radius: 0px; border-bottom-left-radius: 5px;';
      containerAdminMain.style.cssText = 'transition: 1.5s ease margin-right; margin-right : 0px';
      //contenForEfect.style.cssText = "transition: 1.0s ease opacity; opacity : 1"
      setTimeout(() => {
        contenForEfect.classList.remove('closed');
      }, 200);
    } else {

      efectSoundExpan.currentTime = 0; //Reiniciamos el sonido
      efectSoundExpan.play().catch(error => {
                console.error("Error al reproducir el sonido:", error);
            });

      //console.log("altura es diferente de cero", altura);
      nail.style.cssText = 'transition: 1s ease all; margin-bottom: 0px; width: 40px; height: 40px; border-radius: 50%; background-color: rgba(29, 29, 29, 1)'
      containerScoreTrust.style.cssText = 'transition: 1.5s ease height; width: 55px; height: 0; border-top-left-radius: 0px; border-bottom-left-radius: 5px;';
      //contenForEfect.style.cssText = "transition: 2.s ease opacity; opacity : 0";
      containerAdminMain.style.cssText = 'transition: 1.5s ease margin-right; margin-right : 13px';
      setTimeout(() => {
        contenForEfect.classList.add('closed');
      }, 600);
   
      
    }
    
    
  })


</script>  


<script>

  const store = document.querySelector('.store');
  const level = document.querySelector('.level');  
  const imgLevel = document.querySelector('.imgLevel');  
  const scoreLevel = document.querySelector('.scoreLevel');
  const trustLevel = document.querySelector('.trustLevel');
  const from = document.querySelector('.from');
  const yearRegister = document.querySelector('.yearRegister');
  const yearCurrent = document.querySelector('.yearCurrent'); 
  
  const Store = store.childNodes[1].value;
  //console.log("Esto es Store ----------->",Store);
  
  
  let dato = {
    store : Store
  }
  
  //console.log("Esto es dato ---->",dato)
  
  fetch("/record-trust", {
                method: "post",
                body: JSON.stringify(dato),
                headers: { "content-type": "application/json" }
          })
          .then(response => response.json())
          .then(json =>{ console.log("Esto es el Objeto", json)
          
             
              const raffleData = json[0]; 
              const sellerBuySell = json[1].count;
              const sellerTrust = json[2];
  
              console.log("esto es raffleData----->", raffleData);
              console.log("esto es sellerCount---->", sellerBuySell);
              console.log("esto es sellerTrust---->", sellerTrust);

              let sellerPositivo = sellerTrust.positive + raffleData.countRafflePositivo;  
              let sellerNegativo = sellerTrust.negative + raffleData.countRaffleNegativo;
              
              
              const totalOperationSeller = sellerPositivo + sellerNegativo;
  
              if (sellerPositivo !== 0 && totalOperationSeller !== 0 ){
                const tasaTrustSell = ((sellerPositivo * 100) / totalOperationSeller).toFixed(0);
                trustLevel.innerText = tasaTrustSell + '%';
              }


              let countRafflePositivo = raffleData.countRafflePositivo;
              let sellerCount = sellerBuySell + countRafflePositivo;
  
              if ( sellerCount <= 9 ){ // de 0 a 9
                  console.log("Estas en el nivel Carbon como comprador");
                  level.innerText = 'Carbon'
                  imgLevel.innerHTML +=  '<img src="/img/MineralCarbonClean.png" class="m-0" style="width: 40px;">'
                  scoreLevel.innerText = sellerCount;
  
              } else if ( sellerCount <= 19 && sellerCount >= 10 ){ //de 10 a 19 
                  console.log("Estas en el nivel Hierro como vendedor");
                  level.innerText = 'Hierro'
                  imgLevel.innerHTML +=  '<img src="/img/MineralHierroClean.png" style="width: 40px;">'
                  scoreLevel.innerText = sellerCount;
                              
              } else if ( sellerCount <= 49 && sellerCount >= 20 ){ // de 20 a 49 
                  console.log("Estas en el nivel Bronce como vendedor");
                  level.innerText = 'Bronce'
                  imgLevel.innerHTML +=  '<img src="/img/MineralBronceClean.png" style="width: 40px;">'
                  scoreLevel.innerText = sellerCount;
                              
              } else if ( sellerCount <= 99 && sellerCount >= 50 ){ // de 50 a 99
                  console.log("Estas en el nivel Plata como vendedor");
                  level.innerText = 'Plata'
                  imgLevel.innerHTML +=  '<img src="/img/MineralPlataClean.png" style="width: 40px;">'
                  scoreLevel.innerText = sellerCount;
                              
              } else if ( sellerCount <= 199 && sellerCount >= 100 ){ // de 100 a 199
                  console.log("Estas en el nivel Oro como vendedor");
                  level.innerText = 'Oro'
                  imgLevel.innerHTML +=  '<img src="/img/MineralOroClean.png" style="width: 40px;">'
                  scoreLevel.innerText = sellerCount;
           
              } else if ( sellerCount >= 200 ){
                  console.log("Estas en el nivel Diamante como vendedor");
                  level.innerText = 'Diamante'
                  imgLevel.innerHTML +=  '<img src="/img/MineralDiamanteClean.png" style="width: 40px;">'
                  scoreLevel.innerText = sellerCount;
             
              }
           

             
          })
          .catch(err => console.log(err));


          //aqui el fetch para obtener la fecha de creacion
          fetch("/date", {
                method: "post",
                body: JSON.stringify(dato),
                headers: { "content-type": "application/json" }
          })
          .then(resp => resp.json())
          .then(jsonDate =>{
            
            console.log("Esto es jsondate --->",jsonDate)
            const date = jsonDate;
            console.log(date);
            const year = date[0];
            const month = date[1];
            const day = date[2];
            const yearcurrent = date[3];
            
            const dateArmada = `${day}-${month}-${year}`
            from.innerText =  `${dateArmada}` ;
            yearRegister.innerText = `${year}`;
            yearCurrent.innerText = `${yearcurrent}`;
           
          })
          .catch( e => console.log(e))


</script>



<!-- script para calificar -->
<script>
  const modalContent = document.querySelector('.modal-content');
  const containRate = document.querySelector('.containRateStar');
  const btnSendStar = document.getElementById('btnSendStar'); //este es el boton que envia al backend los datos a procesar.
  const eraser = document.querySelector('.bi-eraser');
  const stars = document.querySelectorAll('.starE');
  const commentInp = document.querySelector('.comment');

  const iDStore = document.getElementById('iDStore');
  const iDLogeado = document.getElementById('iDLogeado');
  
  let markStar; //estrella marcada

  stars.forEach((star, index)=>{
    star.addEventListener('click', ()=>{
      //console.log(`se ha marcado la estrella -> ${index + 1}`)
      markStar = `${index + 1}`;
      stars.forEach((s, i)=>{
        if (i <= index){
          s.classList.add('bi-star-fill');
          s.classList.remove('bi-star');
          //console.log("markStar", markStar);
          if (markStar !==0  ){
            //console.log("Se activa el boton de calificacion");
            btnSendStar.removeAttribute('disabled');
          } 
        }
      })
    })

    modalContent.addEventListener('dblclick', ()=>{
      stars.forEach((s)=>{
        s.classList.remove('bi-star-fill');
        s.classList.add('bi-star');
        markStar = 0;
        //console.log("markStar *****", markStar);
        if ( markStar == 0  ){
            //console.log("Se activa el boton de calificacion");
            btnSendStar.setAttribute('disabled', '');
          }
        
      })
    })



  })

  eraser.addEventListener('click', ()=>{
      //console.log("estamos dando click al borrador")
      stars.forEach((s)=>{
        s.classList.remove('bi-star-fill');
        s.classList.add('bi-star');
        markStar = 0;
        //console.log("markStar ---->", markStar);
        //console.log("desactivamos el boton");
        btnSendStar.setAttribute('disabled', '');
      })
  })

  btnSendStar.addEventListener('click', ()=>{
    let store = iDStore.value; 
    let logeado = iDLogeado.value;
    let comment = commentInp.value;

      const datos = {
        store : store,
        logeado : logeado,
        markStar : markStar,
        comment : comment
      };

    fetch('/account/storeRate', {

      method: "post",
      body: JSON.stringify(datos),
      headers: {"content-type" : "application/json"}

    })
      .then(response =>response.json() )
      .then( jsonx => console.log (jsonx) )
      .catch( err => console.log(err));



  })

</script>
  

<!-- script para extraer calificacion de una tienda -->
<script>
  const pountCalif = document.getElementById('pountCalif');
  const pountCount = document.getElementById('pountCount');

 //console.log("Esto es Store ----------->",Store);

  const rate = {
    storeName : Store
  };

  //console.log("Aqui estamos enviando el username de la tienda", rate);

  fetch('/account/pountRate', {

    method: "post",
    body: JSON.stringify(rate),
    headers: {"content-type" : "application/json"}

  })
    .then(response =>response.json() )
    .then( jsonx =>  {
      
        //console.log("recibiendo del backend ->", jsonx)
        const boxRates = []; //aqui meto todas las calificaciones parseadas a numeros
        jsonx.forEach((ele)=>{
          const markStar = ele.markStar;
          const markstar = parseInt(markStar);
          boxRates.push(markstar)
        })
        console.log("boxRates", boxRates);
        let ratesLength = boxRates.length;
        //ahora hacemos el calculo para saber cual es la media de las calificaciones aportadas por los usuarios 
        let sumRate = 0;
        boxRates.forEach((ele)=>{
          const stars = ele
          //console.log("stars >", stars)
          sumRate = sumRate + stars; 
        })

        console.log("sumRate", sumRate);
        console.log("ratesLength", ratesLength);
        const pount = (sumRate / ratesLength);
        const pountRate = pount.toFixed(1); 
        console.log("pountRate", pountRate)

        //ratesLength = 2458965; para probar
        if ( isNaN(pountRate)){
          pountCalif.innerHTML = `0 <i class="bi bi-star-fill"></i>`;
          pountCount.innerHTML = `(0)`
        } else {
          pountCalif.innerHTML = `${pountRate} <i class="bi bi-star-fill"></i>`;
          
          //pountCount.innerHTML = `(${ratesLength})`
          if (ratesLength <= 999){
              pountCount.innerHTML = `<spam style="font-size:13px">(${ratesLength})</spam>`;
            } else if (ratesLength >= 1000 && ratesLength <= 999999 ){
              const reduccion = (ratesLength / 1000)
              const result = reduccion.toFixed(2);
              pountCount.innerHTML = `<spam style="font-size:13px">(${result}K)</spam>`; 
            } else if (ratesLength >= 1000000 && ratesLength <= 999999999 ){
              const reduccion = (ratesLength / 1000000)
              const result = reduccion.toFixed(2);
              pountCount.innerHTML = `<spam style="font-size:13px">(${result}M)</spam>`; 
            }
        }



      
      })
    .catch( err => console.log(err));

</script>


<!-- script para controlar todo el modulo de compartir -->
<script>
  const shareToggle = document.querySelector('.shareToggle');
  const containerShare = document.querySelector('.containerShare');
  const btnClicBoard = document.getElementById('btnClicBoard');
  const btnClicBoardCheck = document.getElementById('btnClicBoardCheck');
  const linkToShare = document.getElementById('linkToShare'); //374 linea
  const btnQR = document.getElementById('btnQR');
  const canvas = document.getElementById('qr-canvas');

   

  shareToggle.addEventListener('click', ()=>{
    containerShare.classList.toggle('invisible')

  })

 
  //copiar link de tienda en el portapapeles
  btnClicBoard.addEventListener('click', ()=>{
    const storeToShare = linkToShare.value;
    navigator.clipboard.writeText(storeToShare)
      .then(function(){
       
        btnClicBoard.classList.add('invisible');
        btnClicBoardCheck.classList.remove('invisible');
        setTimeout(clipboardDone, 1000)
        
        function clipboardDone(){
          btnClicBoardCheck.classList.add('invisible');
          btnClicBoard.classList.remove('invisible');
        }

      })
      .catch(function(error){
        alert("error al copiar" + e);
      })
    
  })

  //fabricar Codigo QR
  btnQR.addEventListener('click', ()=>{

    const store = linkToShare.value;
    const url = `${store}`;
    console.log("url", url);

    const qr = new QRious({
        element: canvas, //en el contenedor donde ira.
        value: url, // informacion que codificara.
        size: 200, // calidad del codigo
        foreground: '#9200ff' // Establece el color violeta
    });

  })

</script>

<script>
  const viewRateStore = document.getElementById('viewRateStore');
  const containerWorkSpace = document.querySelector('.containerWorkSpace');
  const containerViewRatesStore = document.querySelector('.containerViewRatesStore');
  const btnXCloseViewRate = document.getElementById('btnXCloseViewRate'); //icono x para cerrar
  const btnCloseViewRate = document.querySelector('.btnCloseViewRate'); //boton verde para cerrar

  viewRateStore.addEventListener('click', ()=>{
    containerWorkSpace.classList.add('closed');
    containerViewRatesStore.classList.remove('closed');
  })

  btnXCloseViewRate.addEventListener('click', ()=>{
    containerWorkSpace.classList.remove('closed');
    containerViewRatesStore.classList.add('closed');

  })

  btnCloseViewRate.addEventListener('click', ()=>{
    containerWorkSpace.classList.remove('closed');
    containerViewRatesStore.classList.add('closed');

  })
  


</script>

  <!-- script que crea la media de las calificaciones -->
  <script>

    console.log("Store >", Store);

    const pountrate = document.getElementById('pountrate');
    const boxStar = document.querySelector('.boxStar'); 
    const messagevalue = document.querySelector('.containerMessagevalue'); 

    const barStar5 = document.getElementById('barStar5'); //elementos donde incertara la barra de progreso
    const barStar4 = document.getElementById('barStar4'); //elementos donde incertara la barra de progreso
    const barStar3 = document.getElementById('barStar3'); //elementos donde incertara la barra de progreso
    const barStar2 = document.getElementById('barStar2'); //elementos donde incertara la barra de progreso
    const barStar1 = document.getElementById('barStar1'); //elementos donde incertara la barra de progreso

    const pountrateView = document.querySelector('.pountrateView');
    const boxstarView = document.querySelector('.boxstarView'); //boxstarView, puntrateView, countrateView
    const countrateView = document.querySelector('.countrateView');
    let sumStar1= 0; sumStar2= 0; sumStar3= 0; sumStar4= 0; sumStar5= 0; //variables que recojeran los datos para luego sacar el porcentaje.
    let percent1, percent2, percent3, percent4, percent5; //pocentajes por estrellas.
    let boxPercent = [];

    // script para conocer la calificacion de esta tienda
    
      const data = {
        storeName : Store
      };

      fetch('/account/pountRate', {

      method: "post",
      body: JSON.stringify(data),
      headers: {"content-type" : "application/json"}

      })
      .then(response =>response.json() )
      .then( jsonx =>  { 

          //console.log("recibiendo del backend pountrate ->", jsonx)
          const boxRates = []; //aqui meto todas las calificaciones parseadas a numeros
          jsonx.forEach((ele)=>{
            const markStar = ele.markStar;
            const markstar = parseInt(markStar);
            boxRates.push(markstar)
          })
          //console.log("boxRates", boxRates);
          let ratesLength = boxRates.length;
          //ahora hacemos el calculo para saber cual es la media de las calificaciones aportadas por los usuarios 
          let sumRate = 0;
          boxRates.forEach((ele)=>{
            const stars = ele
            //console.log("stars >", stars)
            sumRate = sumRate + stars; 

            if (ele == 1){
              sumStar1 ++;
            } else if (ele ==2){
              sumStar2 ++;
            } else if (ele ==3){
              sumStar3 ++;
            } else if (ele ==4){
              sumStar4 ++;
            } else if (ele ==5){
              sumStar5 ++;
            } 
          })

          //console.log("Con estos datos armo las barras de progrso de las estrellas.")
          //console.log( `sumStar1 :${sumStar1} sumStar2 :${sumStar2} sumStar3 :${sumStar3} sumStar4 :${sumStar4} sumStar5 :${sumStar5}` );
          //console.log("ratesLength: ", ratesLength);
          //console.log("------------------------------------------------------")
          const boxCountStart = [sumStar1, sumStar2, sumStar3, sumStar4, sumStar5];
          boxCountStart.forEach((ele)=>{
            let resultPercent = ((ele * 100) / ratesLength).toFixed(1);
            boxPercent.push(resultPercent);
          })
          //console.log("boxPercent --->", boxPercent);
          //   1* ,   2* ,    3* ,    4* ,    5*
          //['0.0', '40.0', '20.0', '20.0', '20.0']

          for (let i = 0; i < boxPercent.length; i++) {
            const ele = boxPercent[i];
            //console.log("verrrrrrr aqui", i);
            //console.log(`barStar${i + 1} valor : ${ele} `);
            const x = i + 1;
            if (x == 1){
              barStar1.innerHTML = `<div class="progress-bar rounded-2" role="progressbar" style="width: ${ele}%" aria-valuenow="${ele}" aria-valuemin="0" aria-valuemax="100">  </div>` 
            } else if (x == 2) {
              barStar2.innerHTML = `<div class="progress-bar rounded-2" role="progressbar" style="width: ${ele}%" aria-valuenow="${ele}" aria-valuemin="0" aria-valuemax="100">  </div>` 
            } else if (x == 3) {
              barStar3.innerHTML = `<div class="progress-bar rounded-2" role="progressbar" style="width: ${ele}%" aria-valuenow="${ele}" aria-valuemin="0" aria-valuemax="100">  </div>` 
            } else if (x == 4) {
              barStar4.innerHTML = `<div class="progress-bar rounded-2" role="progressbar" style="width: ${ele}%" aria-valuenow="${ele}" aria-valuemin="0" aria-valuemax="100">  </div>` 
            } else if (x == 5) {
              barStar5.innerHTML = `<div class="progress-bar rounded-2" role="progressbar" style="width: ${ele}%" aria-valuenow="${ele}" aria-valuemin="0" aria-valuemax="100">  </div>` 
            }
                      
            /* `barStar${i}`.innerHTML = `<div class="progress-bar rounded-2" role="progressbar" style="width: ${ele}%" aria-valuenow="${ele}" aria-valuemin="0" aria-valuemax="100">  </div>` */
          }
          

          //console.log("sumRate", sumRate);
          //console.log("ratesLength", ratesLength);
          const pount = (sumRate / ratesLength);
          let pountRate; 
          pountRate = parseFloat( pount.toFixed(1)); 
          //console.log("pountRate", pountRate);
          //console.log("ratesLength", ratesLength);
          //console.log("pountRate", typeof pountRate)
          //boxstarView, puntrateView, countrateView
          pountrateView.innerText = pountRate; //esto muestra la calificacion en la vista dodne estan todas las calificaciones
          countrateView.innerText = ratesLength; //esto muestra la cantidad de calificaciones y opiniones.   

          if (isNaN (pountRate)){

            boxstarView.innerHTML = ` <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                    `                    

          } else if (pountRate == 0 ){

            boxstarView.innerHTML  = `<i class="bi bi-star-half mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                    `                            

          } else if (pountRate > 0 && pountRate < 1){

            boxstarView.innerHTML = ` <i class="bi bi-star-half mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                    `                      
                 
          } else if (pountRate == 1 ){
            boxstarView.innerHTML = ` <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                    `                                            
                            
          } else if (pountRate > 1 && pountRate < 2){
            boxstarView.innerHTML = ` <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-half mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                    `                      
                     
          } else if (pountRate == 2){
            boxstarView.innerHTML = ` <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                     <i class="bi bi-star mx-1"></i>
                                    `                                  

          } else if (pountRate > 2 && pountRate < 3){
            boxstarView.innerHTML = ` <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-half mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      `                                  
          } else if (pountRate == 3 ){
            boxstarView.innerHTML = ` <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                     `                                   

          } else if (pountRate > 3 && pountRate < 4){
            boxstarView.innerHTML = ` <i class="bi bi-star-fill"></i>
                                      <i class="bi bi-star-fill"></i>
                                      <i class="bi bi-star-fill"></i>
                                      <i class="bi bi-star-half"></i>
                                      <i class="bi bi-star"></i>
                                      `                                  

          } else if (pountRate == 4 ){
            boxstarView.innerHTML = ` <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      `                                    

          } else if (pountRate > 4 && pountRate < 5){
            boxstarView.innerHTML = ` <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-half mx-1"></i>
                                      `                                  

          } else if (pountRate == 5){
            boxstarView.innerHTML = ` <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-fill mx-1"></i>
                                      `                                  
          } 


        
        })
      .catch( err => console.log(err));
    

  </script>

  <script>
    const bodyRates = document.getElementById('bodyRates');

    const btnRateAll = document.querySelector('.btnRateAll');
    const btnRate5 = document.querySelector('.btnRate5');
    const btnRate4 = document.querySelector('.btnRate4');
    const btnRate3 = document.querySelector('.btnRate3');
    const btnRate2 = document.querySelector('.btnRate2');
    const btnRate1 = document.querySelector('.btnRate1');


      const rateAll = {
        storeName : Store
      };

      fetch('/account/pountRate', {

        method: "post",
        body: JSON.stringify(rateAll),
        headers: {"content-type" : "application/json"}

      })
      .then(response =>response.json() )
      .then( jsonx =>  { 
          
          //console.log("Con estos datos armare la lista de las calificaciones", jsonx);

          jsonx.forEach((ele)=>{

              //console.log("dataLogeado ->", ele.dataLogeado);
              const dataLogeado = ele.dataLogeado;
              const username = dataLogeado.username;
              const mailhash = dataLogeado.mailhash;
              const avatarPerfil = dataLogeado.avatarPerfil;
              //console.log("avatarPerfil >", avatarPerfil);
              //console.log("markStar ->", ele.markStar);
              const markstar = ele.markStar;
              //console.log("markstar -->", markstar) 
              //console.log("comment ->", ele.comment);
              let comment;
              comment = ele.comment;


              if (comment === ""){
                comment = "¡Sin comentarios!"
              } 

              const updatedAt = ele.updatedAt; const date = new Date(updatedAt); 
              let dia = date.getDate(); let mes = date.getMonth() +1; let anio = date.getFullYear();
              const fecha = `${dia}-${mes}-${anio}`;


                  if (avatarPerfil[0].public_id === 'sin_data'){
                      
                      if (markstar == 1){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span>

                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>            
                                        `
                      } else if (markstar == 2){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span>
                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>            
                                        `
                      } else if (markstar == 3){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span> 
                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>            
                                        `
                      } else if (markstar == 4){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                        <i class="bi bi-star-fill"></i>
                                                                        <i class="bi bi-star-fill"></i>
                                                                        <i class="bi bi-star-fill"></i>
                                                                        <i class="bi bi-star"></i> </span>
                                                                        <span class="ms-2"> ${fecha} </span> 
                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>            
                                        `
                      } else if (markstar == 5){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span> 
                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>               
                                        `
                      }   

                  } else {
 
                      if (markstar == 1){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span>

                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>           
                                        ` 
                      } else if (markstar == 2){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span>

                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>           
                                        ` 
                      } else if (markstar == 3){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span>

                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>           
                                        `                   
                      } else if (markstar == 4){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span>

                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>           
                                        `                   
                      } else if (markstar == 5){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span>

                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>           
                                        `                  
                      }
 
                  }            

 
          })


        })
      .catch((error)=>{
        console.log("Ha habido un problema con la carga de calificaciones")
      })

  
        //filtrar por 1 estrellas
        btnRate1.addEventListener('click', ()=>{

            const rate = {
              storeName : Store
            };

            fetch('/account/pountRate/star-1', {

              method: "post",
              body: JSON.stringify(rate),
              headers: {"content-type" : "application/json"}

              })
            .then(response =>response.json() )
            .then( jsonx =>  { 
              
              //console.log("consolta 1 star -> ", jsonx)
              bodyRates.innerHTML = ""; //limpiamos todo antes de colocar los nuevos elementos.
              jsonx.forEach((ele)=>{
                
                const dataLogeado = ele.dataLogeado;
                const avatarPerfil = dataLogeado.avatarPerfil;
                const mailhash = dataLogeado.mailhash;
                const username = dataLogeado.username;

                let comment;
                comment = ele.comment;

                if (comment === ""){
                  comment = "¡Sin comentarios!"
                }

                const updatedAt = ele.updatedAt; const date = new Date(updatedAt); 
                let dia = date.getDate(); let mes = date.getMonth() +1; let anio = date.getFullYear();
                const fecha = `${dia}-${mes}-${anio}`;

                //console.log(`|-> avatarPerfil : ${avatarPerfil} mailhash : ${mailhash} username : ${username}`)

                if (avatarPerfil[0].public_id === 'sin_data'){
                      //carece de avatar customizado usar el hashmail
                      bodyRates.innerHTML += `
                                  <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                    <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                    <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                            <i class="bi bi-star"></i>
                                                            <i class="bi bi-star"></i>
                                                            <i class="bi bi-star"></i>
                                                            <i class="bi bi-star"></i> </span>
                                                            <span class="ms-2"> ${fecha} </span> 
                                    </p>
                                    <p class="mb-1"> <span> ${comment} </span> </p>
                                  </div>               
                                  `

                } else {
                  bodyRates.innerHTML += `
                                  <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                    <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                    <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                            <i class="bi bi-star"></i>
                                                            <i class="bi bi-star"></i>
                                                            <i class="bi bi-star"></i>
                                                            <i class="bi bi-star"></i> </span>
                                                            <span class="ms-2"> ${fecha} </span>

                                    </p>
                                    <p class="mb-1"> <span> ${comment} </span> </p>
                                  </div>           
                                  `   
                }  

              })
               

            })
            .catch((err)=>{ console.log(err) }); 
          


            
        }) 

        //filtrar por 2 estrellas
        btnRate2.addEventListener('click', ()=>{

          const rate = {
            storeName : Store
          };
          
          fetch('/account/pountRate/star-2', {

            method: "post",
            body: JSON.stringify(rate),
            headers: {"content-type" : "application/json"}

            })
          .then(response =>response.json() )
          .then( jsonx =>  {
            
            //console.log("consolta 2 star -> ", jsonx)
            bodyRates.innerHTML = ""; //limpiamos todo antes de colocar los nuevos elementos.
            jsonx.forEach((ele)=>{
              
              const dataLogeado = ele.dataLogeado;
              const avatarPerfil = dataLogeado.avatarPerfil;
              const mailhash = dataLogeado.mailhash;
              const username = dataLogeado.username;

              let comment;
              comment = ele.comment;

              if (comment === ""){
                comment = "¡Sin comentarios!"
              }

              const updatedAt = ele.updatedAt; const date = new Date(updatedAt); 
              let dia = date.getDate(); let mes = date.getMonth() +1; let anio = date.getFullYear();
              const fecha = `${dia}-${mes}-${anio}`;              

              //console.log(`|-> avatarPerfil : ${avatarPerfil} mailhash : ${mailhash} username : ${username}`)

              
              if (avatarPerfil[0].public_id === 'sin_data'){
                    //carece de avatar customizado usar el hashmail
                    bodyRates.innerHTML += `
                                <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                  <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                  <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star"></i>
                                                          <i class="bi bi-star"></i>
                                                          <i class="bi bi-star"></i> </span>
                                                          <span class="ms-2"> ${fecha} </span> 
                                  </p>
                                  <p class="mb-1"> <span> ${comment} </span> </p>
                                </div>               
                                `

              } else {
                bodyRates.innerHTML += `
                                <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                  <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                  <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star"></i>
                                                          <i class="bi bi-star"></i>
                                                          <i class="bi bi-star"></i> </span>
                                                          <span class="ms-2"> ${fecha} </span>

                                  </p>
                                  <p class="mb-1"> <span> ${comment} </span> </p>
                                </div>           
                                `   
              }  

            })
            

           })
          .catch((err)=>{ console.log(err) }); 
        
        }) 
  
        //filtrar por 3 estrellas
        btnRate3.addEventListener('click', ()=>{

          const rate = {
            storeName : Store
          };

          fetch('/account/pountRate/star-3', {

            method: "post",
            body: JSON.stringify(rate),
            headers: {"content-type" : "application/json"}

            })
          .then(response =>response.json() )
          .then( jsonx =>  {
            
            //console.log("consolta 3 star -> ", jsonx)
            bodyRates.innerHTML = ""; //limpiamos todo antes de colocar los nuevos elementos.
            jsonx.forEach((ele)=>{
              
              const dataLogeado = ele.dataLogeado;
              const avatarPerfil = dataLogeado.avatarPerfil;
              const mailhash = dataLogeado.mailhash;
              const username = dataLogeado.username;

              let comment;
              comment = ele.comment;

              if (comment === ""){
                comment = "¡Sin comentarios!"
              }

              const updatedAt = ele.updatedAt; const date = new Date(updatedAt); 
              let dia = date.getDate(); let mes = date.getMonth() +1; let anio = date.getFullYear();
              const fecha = `${dia}-${mes}-${anio}`;              

              //console.log(`|-> avatarPerfil : ${avatarPerfil} mailhash : ${mailhash} username : ${username}`)

              
              if (avatarPerfil[0].public_id === 'sin_data'){
                    //carece de avatar customizado usar el hashmail
                    bodyRates.innerHTML += `
                                <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                  <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                  <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star"></i>
                                                          <i class="bi bi-star"></i> </span>
                                                          <span class="ms-2"> ${fecha} </span> 
                                  </p>
                                  <p class="mb-1"> <span> ${comment} </span> </p>
                                </div>               
                                `

              } else {
                bodyRates.innerHTML += `
                                <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                  <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                  <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star"></i>
                                                          <i class="bi bi-star"></i> </span>
                                                          <span class="ms-2"> ${fecha} </span>

                                  </p>
                                  <p class="mb-1"> <span> ${comment} </span> </p>
                                </div>           
                                `   
              }  

            })

          })
          .catch((err)=>{ console.log(err) }); 

        }) 

        //filtrar por 4 estrellas
        btnRate4.addEventListener('click', ()=>{

          const rate = {
            storeName : Store
          };

          fetch('/account/pountRate/star-4', {

            method: "post",
            body: JSON.stringify(rate),
            headers: {"content-type" : "application/json"}

            })
          .then(response =>response.json() )
          .then( jsonx =>  {
            
            //console.log("consolta 4 star -> ", jsonx)
            bodyRates.innerHTML = ""; //limpiamos todo antes de colocar los nuevos elementos.
            jsonx.forEach((ele)=>{
              
              const dataLogeado = ele.dataLogeado;
              const avatarPerfil = dataLogeado.avatarPerfil;
              const mailhash = dataLogeado.mailhash;
              const username = dataLogeado.username;

              let comment;
              comment = ele.comment;

              if (comment === ""){
                comment = "¡Sin comentarios!"
              }

              const updatedAt = ele.updatedAt; const date = new Date(updatedAt); 
              let dia = date.getDate(); let mes = date.getMonth() +1; let anio = date.getFullYear();
              const fecha = `${dia}-${mes}-${anio}`;              

              //console.log(`|-> avatarPerfil : ${avatarPerfil} mailhash : ${mailhash} username : ${username}`)

              
              if (avatarPerfil[0].public_id === 'sin_data'){
                    //carece de avatar customizado usar el hashmail
                    bodyRates.innerHTML += `
                                <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                  <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                  <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star"></i> </span>
                                                          <span class="ms-2"> ${fecha} </span> 
                                  </p>
                                  <p class="mb-1"> <span> ${comment} </span> </p>
                                </div>               
                                `

              } else {
                bodyRates.innerHTML += `
                                <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                  <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                  <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star"></i> </span>
                                                          <span class="ms-2"> ${fecha} </span>

                                  </p>
                                  <p class="mb-1"> <span> ${comment} </span> </p>
                                </div>           
                                `   
              }  

            })

          })
          .catch((err)=>{ console.log(err) }); 

        }) 

        //filtrar por 5 estrellas
        btnRate5.addEventListener('click', ()=>{

          const rate = {
            storeName : Store
          };

          fetch('/account/pountRate/star-5', {

            method: "post",
            body: JSON.stringify(rate),
            headers: {"content-type" : "application/json"}

            })
          .then(response =>response.json() )
          .then( jsonx =>  {
            
            //console.log("consulta 5 star -> ", jsonx)
            bodyRates.innerHTML = ""; //limpiamos todo antes de colocar los nuevos elementos.
            jsonx.forEach((ele)=>{
              
              const dataLogeado = ele.dataLogeado;
              const avatarPerfil = dataLogeado.avatarPerfil;
              const mailhash = dataLogeado.mailhash;
              const username = dataLogeado.username;

              let comment;
              comment = ele.comment;

              if (comment === ""){
                comment = "¡Sin comentarios!"
              }

              const updatedAt = ele.updatedAt; const date = new Date(updatedAt); 
              let dia = date.getDate(); let mes = date.getMonth() +1; let anio = date.getFullYear();
              const fecha = `${dia}-${mes}-${anio}`;              

              //console.log(`|-> avatarPerfil : ${avatarPerfil} mailhash : ${mailhash} username : ${username}`)

              
              if (avatarPerfil[0].public_id === 'sin_data'){
                    //carece de avatar customizado usar el hashmail
                    bodyRates.innerHTML += `
                                <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                  <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                  <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i> </span>
                                                          <span class="ms-2"> ${fecha} </span> 
                                  </p>
                                  <p class="mb-1"> <span> ${comment} </span> </p>
                                </div>               
                                `

              } else {
                bodyRates.innerHTML += `
                                <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                  <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                  <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i> </span>
                                                          <span class="ms-2"> ${fecha} </span>

                                  </p>
                                  <p class="mb-1"> <span> ${comment} </span> </p>
                                </div>           
                                `   
              }  

            })

          })
          .catch((err)=>{ console.log(err) }); 

        }) 

        //filtrar por All estrellas
        btnRateAll.addEventListener('click', ()=>{

          const rate = {
            storeName : Store
          };

          fetch('/account/pountRate', {

            method: "post",
            body: JSON.stringify(rate),
            headers: {"content-type" : "application/json"}

            })
          .then(response =>response.json() )
          .then( jsonx =>  {
            
            //console.log("consolta All star -> ", jsonx)
            bodyRates.innerHTML = ""; //limpiamos todo antes de colocar los nuevos elementos.
            jsonx.forEach((ele)=>{
                                   
              const markstar = ele.markStar;
              const dataLogeado = ele.dataLogeado;
              const avatarPerfil = dataLogeado.avatarPerfil;
              const mailhash = dataLogeado.mailhash;
              const username = dataLogeado.username;

              let comment;
              comment = ele.comment;

              if (comment === ""){
                comment = "¡Sin comentarios!"
              }

              const updatedAt = ele.updatedAt; const date = new Date(updatedAt); 
              let dia = date.getDate(); let mes = date.getMonth() +1; let anio = date.getFullYear();
              const fecha = `${dia}-${mes}-${anio}`;              

              //console.log(`|-> avatarPerfil : ${avatarPerfil} mailhash : ${mailhash} username : ${username}`)

              if (avatarPerfil[0].public_id === 'sin_data'){
              //console.log("avatarPerfil[0] ", avatarPerfil[0]); 
              //console.log("markstar ", markstar);       
                      if (markstar == 1){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span>

                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>            
                                        `
                      } else if (markstar == 2){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span>
                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>            
                                        `
                      } else if (markstar == 3){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span> 
                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>            
                                        `
                      } else if (markstar == 4){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                        <i class="bi bi-star-fill"></i>
                                                                        <i class="bi bi-star-fill"></i>
                                                                        <i class="bi bi-star-fill"></i>
                                                                        <i class="bi bi-star"></i> </span>
                                                                        <span class="ms-2"> ${fecha} </span> 
                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>            
                                        `
                      } else if (markstar == 5){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span> 
                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>               
                                        `
                      }   

                  } else {
 
                      if (markstar == 1){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span>

                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>           
                                        ` 
                      } else if (markstar == 2){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span>

                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>           
                                        ` 
                      } else if (markstar == 3){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span>

                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>           
                                        `                   
                      } else if (markstar == 4){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span>

                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>           
                                        `                   
                      } else if (markstar == 5){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span>

                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>           
                                        `                  
                      }
 
                  }                
              
  


            })

          })
          .catch((err)=>{ console.log(err) }); 

        }) 


        
  </script>


<% if ( user !== undefined ) { %>
  <!-- estas son las opciones que estaran cuando SI exista un usuario logeado -->
<script>
    //este script es para manejar la accion de los favoritos dentro de la tienda.
    const linkHeart = document.querySelectorAll('.linkHeart')
    for (let i = 0; i < linkHeart.length; i++) {
      const element = linkHeart[i];
      element.addEventListener('click', () => {

        efecto()
        setInterval(normalHeart, 2000)
        //console.log(element.childNodes)
        //console.log(element.childNodes[0].value)
        //console.log(element.childNodes[1].value)
        const depart = element.childNodes[0].value;
        const id = element.childNodes[1].value;
        console.log(depart)
        console.log(id)

        const datos = {
          depart: depart,
          id: id
        }

        fetch('/myfavorites', {

          method: "post",
          body: JSON.stringify(datos),
          headers: { "content-type": "application/json" }

        })
          .then(response => response.json())
          .then(jsonx => console.log(jsonx))
          .catch(err => console.log(err));

      })


      function efecto() {
        element.classList.remove('bi-heart');
        element.classList.add('bi-heart-fill')
      }

      function normalHeart() {
        element.classList.remove('bi-heart-fill');
        element.classList.add('bi-heart')
      }


    }

</script>

<script>
 //este es el controlador de las ofertas
  const offer = document.querySelectorAll('.offer');
  const boxDetail = document.querySelectorAll('.boxDetail');

  for (let i = 0; i < offer.length; i++) {
    const element = offer[i];
    element.addEventListener('click', () => {
  
      //console.log(element.childNodes)
      console.log("depart ---->",element.childNodes[1].value);
      console.log("id ---->",element.childNodes[3].value);
      
      const depart = element.childNodes[1].value;
      const id = element.childNodes[3].value;
      
      const datos = {
          depart: depart,
          id: id
        }

        fetch('/account/offer', {

          method: "post",
          body: JSON.stringify(datos),
          headers: { "content-type": "application/json" }

        })
          .then(response => response.json())
          .then(jsonx => {
            
            console.log("Esto es jsonx--->",jsonx)
            const Offer = jsonx[0].offer;

            if ( Offer === false ){
              boxDetail[i].style.backgroundColor = "#fcda57";
            } else {
              boxDetail[i].style.backgroundColor = "#ffffff";
            }

          })
          .catch(err => console.log(err));
  
  
    });
  
  };
  
</script>

<script>
  //este es el controlador bestProduct
   const bestProduct = document.querySelectorAll('.bestProduct');
   const containBestProduct = document.querySelectorAll('.containBestProduct');
 
   for (let e = 0; e < bestProduct.length; e++) {
     const element = bestProduct[e];
     element.addEventListener('click', () => {
   
       //console.log(element.childNodes)
       console.log("depart ---->",element.childNodes[1].value);
       console.log("id ---->",element.childNodes[3].value);
       
       const depart = element.childNodes[1].value;
       const id = element.childNodes[3].value;
       
       const datos = {
           depart: depart,
           id: id
         }
 
         fetch('/account/best-product', {
 
           method: "post",
           body: JSON.stringify(datos),
           headers: { "content-type": "application/json" }
 
         })
           .then(response => response.json())
           .then(jsonx => {
             
             console.log("Esto es jsonx--->",jsonx)
             const BestProduct = jsonx[0].bestProduct;
 
             if ( BestProduct === false ){
              containBestProduct[e].innerHTML = '<i class="bi bi-award"></i>';
             } else {
              containBestProduct[e].innerHTML = '';
             }
 
           })
           .catch(err => console.log(err));
   
   
     });
   
   };
   
</script>

<script>
  //este es el controlador del onlyOneAvailable
   const onlyOneAvailable = document.querySelectorAll('.onlyOneAvailable');
   const containerOnlyOneAvailable = document.querySelectorAll('.containerOnlyOneAvailable');
 

   for (let g = 0; g < onlyOneAvailable.length; g++) {
     const element = onlyOneAvailable[g];
     element.addEventListener('click', () => {
   
       //console.log(element.childNodes)
       console.log("depart ---->",element.childNodes[1].value);
       console.log("id ---->",element.childNodes[3].value);
       
       const depart = element.childNodes[1].value;
       const id = element.childNodes[3].value;
       
       const datos = {
           depart: depart,
           id: id
         }
 
         fetch('/account/only-one-available', {
 
           method: "post",
           body: JSON.stringify(datos),
           headers: { "content-type": "application/json" }
 
         })
           .then(response => response.json())
           .then(jsonx => {
             
             console.log("Esto es jsonx--->",jsonx)
             const OnlyOneAvailable = jsonx[0].onlyOneAvailable;
 
             if ( OnlyOneAvailable === false ){
              containerOnlyOneAvailable[g].innerHTML = '<i class="bi bi-1-square-fill me-1"></i>';
             } else {
              containerOnlyOneAvailable[g].innerHTML = '';
             }
 
           })
           .catch(err => console.log(err));
   
   
     });
   
   };
   
</script>

<script>
  //este es el controlador de los delivery
   const delivery = document.querySelectorAll('.delivery');
   const containerDelivery = document.querySelectorAll('.containerDelivery');
   console.log("------- containerDelivery ---------", containerDelivery);
  

   for (let i = 0; i < delivery.length; i++) {
     const element = delivery[i];
     element.addEventListener('click', () => {
       console.log("Esto es i -->", i);
       //console.log(element.childNodes)
       console.log("depart ---->",element.childNodes[1].value);
       console.log("id ---->",element.childNodes[3].value);
       
       const depart = element.childNodes[1].value;
       const id = element.childNodes[3].value;
       
       const datos = {
           depart: depart,
           id: id
         }
 
         fetch('/account/delivery', {
 
           method: "post",
           body: JSON.stringify(datos),
           headers: { "content-type": "application/json" }
 
         })
           .then(response => response.json())
           .then(jsonx => {
             
             console.log("Esto es jsonx--->",jsonx);
             const ID = jsonx[0]._id;
             const Delivery = jsonx[0].delivery;
             console.log("Esto es ID ---->", ID);
             console.log("Esto es Delivery ---->", Delivery);
 
             if ( Delivery === false ){
                containerDelivery[i].innerHTML = '<i class="bi bi-truck me-1"></i>'
             } else {        
                containerDelivery[i].innerHTML = '';
             }
 
           })
           .catch(err => console.log(err));
   
   
     });
   
   };
   
</script>


<% }; %>


</body>


