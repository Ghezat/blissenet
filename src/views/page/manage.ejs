<!DOCTYPE html>
<html lang="en">

<head>
  <%- include('../partials/head.ejs') %>
    <title>Blissenet Gerencia</title>
</head>
<style>
  
  .imgPerfil{
    width: 55px;
    border-radius: 4px;
}

  .departGroup {
    background-color: rgb(197, 103, 103);
    border: 1px ridge brown;
    list-style: none;
    margin: 0;
  }

  .departList {
    background-color: rgb(243, 205, 205);
    padding: 0px 8px;
    color: rgb(54, 52, 49);
    border-radius: 12px;
  }

  .textDecorativeNo {
    text-decoration: none;
  }

 /*  .contentAdmin{
    display: flex;
    justify-content: center;
  } */

  .cursor-pointer{
    cursor: pointer;
  }

  .contentAnalisys{
    display: flex;
    flex-direction: row;
    justify-content: space-evenly;
  }

  .open{
    display: block;
  }

  .blackBody{
    /* esta es la clase que utiliza bodyTheme */
    background-color: #272b2f;
  }

  .closed{
    display: none !important;
  }

  .contentFascinometro{
      width: 100%;
      height:120vh;
  }

  .contentVistometro{
      width: 100%;
      height:120vh;
  }

  .textLight{
      /* trabaja en conjunto con themaTextLight */
      color: white;
  }



    @media screen and (min-width: 510px) and (max-width: 900px ){
    .contentAdmin{
      padding: 0px !important; 
      width: 100%;
  
    }

    .mainTable{
      margin: 0;
      width: 100%;
    }

    .contentFascinometro{
      width: 100%;
      height:auto;
    }

    .contentVistometro{
      width: 100%;
      height:auto;
    }
  
  }
        
  @media screen and (min-width: 180px) and (max-width: 510px ){
    .contentAdmin{
      padding: 0px !important; 
      width: 100%;
  
    }

    .mainTable{
      margin: 0;
      width: 100%;
    }

    .contentFascinometro{
      width: 100%;
      height:auto;
    }

    .contentVistometro{
      width: 100%;
      height:auto;
    }
    
  }

</style>

<body class="mainTheme">


  <main>

    <%- include('../partials/navi-simple.ejs') %>
  
    <% if (user){ %>
      <% const seeMarket = user.seeMarket %>
      <% const idUser = user._id %>
      <input type="hidden" value="<%= seeMarket.countryMarketCode %>" id="seeMarket">
      <input type="hidden" value="<%= idUser %>" id= "idUser">
      <!-- este bloque me permite validad si el usuario que se logea tiene un mercado definido. sino lo tiene debe obligatoriamente hacerlo. --> 

      <% if (searchProfile.length !==0) { %>
        <div class="container-fluid p-0" style="height: auto;">
          <div class="row rowWidth m-0">
              <div class="col-12 p-0">


                  <!-- esta data es para usarla abajo en un script para poder enviar un fecth con el nombre de la tienda. -->
                  <input type="hidden" value="<%= searchProfile[0].username %>" id="nameStore"> 

                
              </div>

              <!-- <div class="container-fluid d-flex justify-content-between p-1" style="background-color:  rgb(243, 238, 238); box-shadow: 1px 1px 5px 1px rgb(99, 98, 98);  border-top: 2px ridge  rgb(243, 238, 238);"> -->
                
  
              <div class="container-fluid d-flex justify-content-between py-2" style="background: linear-gradient(90deg, rgba(146,0,255,1) 0%, rgba(174,65,255,1) 50%, rgba(13,110,253,1) 100%)";>
                <div class="ms-2 p-0" style="font-weight: 400; color: #ffde00;"> <b> Gerencia de Análisis </b>  </div>
                
                <div class="btn-group btn-group-sm mx-2" role="group" aria-label="Basic example">
                  <button type="button" class="btn btn-dark active" id="btnAdmin">Estados</button>
                  <button type="button" class="btn btn-dark" id="btnAnalysis">Análisis</button>
                </div>
              </div> 
         
              
              <div class="row m-0 px-5 pb-5 contentAdmin bodyTheme" style="width: 100%; height: auto;">
                  
                  <div class="mainTable" style="overflow-x: auto; width: 100%;">
                      <table class="table tableBox">
                        <thead>
                          <tr>
                             <th>Image</th> <th>Title</th> <th>Department</th> <th>Price</th> <th>Favorites</th> <th>Views</th> <th>Pausar/Activar</th> <th>Store</th>
                          </tr>
                        </thead>
                        <tbody>  
                         <% if (newBox) { %>
                             <% newBox.forEach((ele)=>{ %>
                                 <tr>  
                                  
                                     <td><img src="<%= ele.images[0].url %>"class="border"  style="width: 45px; height: 45px; object-fit: contain;" > </td>
                                     <td> <a href="/product/<%= ele.department %>/<%= ele._id %>/<%= ele.titleURL %>"> <%= ele.title %></a> </td> 
                                     <td><%= ele.department %></td>
                                     <td><%= ele.price %></td>
                                     <td><span class="me-2"><i class="bi bi-heart"></i></span> <%= ele.favorite%></td>
                                     <td><span class="me-2"><i class="bi bi-eye"></i></span><%= ele.view %></td>
                                     <% if (ele.paused == false) { %>
                                     <td> <a href="/myaccount/manage/<%= ele.department %>/<%= ele._id %>" class="btn btn-primary mx-2">Activado</a></td>
                                     <% } else { %>
                                     <td> <a href="/myaccount/manage/<%= ele.department %>/<%= ele._id %>" class="btn btn-secondary mx-2">Pausado</a></td>  
                                     <% }; %>
                                     <% if (ele.visibleStore === true ) { %>
                                     <td> <a href="/myaccount/visible-store/<%= ele.department %>/<%= ele._id %>" class="btn btn-primary mx-2">Visible</a></td> 
                                     <% } else { %>
                                     <td> <a href="/myaccount/visible-store/<%= ele.department %>/<%= ele._id %>" class="btn btn-secondary mx-2">Invisible</a></td> 
                                      <% }; %>

                                 </tr>  
                              <% }) %>
                          <% }; %>    
                        </tbody>         
                      </table>
                  </div>
                  <% if (newBox.length !==0 ) { %>
                  <div class="paginate elementPaginate my-3">
                    <nav aria-label="...">
                      <ul class="pagination  m-0" >
                        <% if (paginate) { %>

                          <% if ( paginate.pagina == 1 ) { %>
                          <li class="page-item disabled">
                            <a class="page-link" href="?paginate=first"> <i class="bi bi-arrow-bar-left"></i> 1</a>
                          </li>
                          <% } else { %>
                            <li class="page-item">
                              <a class="page-link" href="?paginate=first"> <i class="bi bi-arrow-bar-left"></i> 1</a>
                            </li>  
                          <% }; %>  

                          <% if ( paginate.pagina == 1 ) { %>
                          <li class="page-item prev disabled">
                            <a class="page-link" href="?paginate=prev"> Prev</a>
                          </li>
                          <% } else { %>
                          <li class="page-item prev">
                            <a class="page-link" href="?paginate=prev"> Prev </a>
                          </li>  
                          <% }; %>
                          <li class="page-item active">
                            <span class="page-link pagina"><%= paginate.pagina %></span>
                          </li>
                          <% if ( paginate.pagina == paginate.totalPagina ) { %>
                          <li class="page-item next disabled">
                            <a class="page-link" href="?paginate=next"> Next</i></a>
                          </li>
                          <% } else { %>
                          <li class="page-item next">
                            <a class="page-link" href="?paginate=next"> Next</i> </a>
                          </li>  
                          <% }; %>

                          <% if ( paginate.pagina == paginate.totalPagina ) { %>
                          <li class="page-item disabled">
                            <a class="page-link" href="?paginate=last"> <%= paginate.totalPagina %> <i class="bi bi-arrow-bar-right"></i></a>
                          </li>
                          <% } else { %>
                          <li class="page-item">
                            <a class="page-link" href="?paginate=last"> <%= paginate.totalPagina %> <i class="bi bi-arrow-bar-right"></i></a>
                          </li>  
                          <% }; %>  

                        <% }; %>
                      </ul>
                    </nav>
                  </div>
                  <% }; %>

              </div>
              
              <div class="row m-0 contentAnalisys d-flex closed p-0 flex-wrap bodyTheme">
                  <div class="col-12 col-sm-12 col-md-12 col-lg-3 col-xl-3 col-xxl-3 mt-3 p-0">

                      <div class="containerMetricasGenerales m-3 border rounded-2 shadow themaTextLight">
                          <div class="containerTitle mb-2 py-2 alert-secondary">
                            <span style="margin-left: 10px;"> Métricas Generales </span> 
                          </div>
                            <% searchProfile.forEach((ele)=>{ %>
                              <div class="containerVistometro m-1" >
                                <span style="margin-left: 8px;">Visitas a mi Tienda : <strong class="ms-1" ><%= ele.view %></strong> </span> 
                            </div>
                            <% }) %>
                          
                            <% if (followMeCount) { %>
                              <div class="containerFascinometro m-1">
                                <span style="margin-left: 8px;">Siguiendome : <strong class="ms-1"> <%= followMeCount %> </strong> </span>
                              </div>
                            <% } %>
                            <% if (followingCount) { %>
                              <div class="containerFascinometro m-1">
                                <span style="margin-left: 8px;">Siguiendo : <strong class="ms-1"> <%= followingCount %> </strong> </span>
                              </div>
                            <% } %>
                            
                                               
                            <div class="containerValorTienda m-1">
                                <span style="margin-left: 8px; margin-top: 10px;">Valoración de Tienda: <span class="fw-bold ms-1" id="pountrate"> <!-- Dinamic --> </span>  </span>
                                <div class="boxStar mx-2 border d-flex justify-content-center" style="margin-top: 10px;" >
                                  <!-- Dinamic -->
                                </div>
                                <div class="containerMessagevalue mx-2 rounded-1">
                                  <!-- Dinamic -->
                                </div>
                            </div>

                            <div class="form-group m-1 px-2">
                              <button class="btn btn-secondary form-control" id="btnRateView"> Ver Calificaciones</button>
                            </div>
                                              

                            <hr>
                            <% if (boxPublisher) {  %>
                              <div class="containerAnunciosActivos m-1">
                                <span style="margin-left: 8px;">Todos mis Anuncios : <%= boxPublisher.length %></span>
                            </div>
                            <% }; %> 
                        
                            <% if (objActive) { %>
                              <div class="containerAnunciosActivos m-1">
                                <span style="margin-left: 8px;">Anuncios Activos : <%= objActive.active %></span>
                            </div>
                            <% }; %>  
                          
                            <% if (objActive) { %>
                              <div class="containerAnunciosPasivos mx-1 mt-1 mb-3">
                                <span style="margin-left: 8px;">Anuncios Pausados : <%= objActive.paused %></span>
                              </div>
                          <% }; %>
                      </div>

                      <div class="containerDataMain m-3 p-1 border rounded-2 shadow themaTextLight">
                          <ul class="nav nav-tabs">
                            <li class="nav-item">
                                  <button class="nav-link active" id="btnSeller"> Vendedor</button>
                            </li>
                            <li class="nav-item">
                              <button class="nav-link" id="btnBuyer"> Comprador</button>
                            </li>
                          </ul>

                          <div class="containerSeller m-1 p-1">
                            <ul style="list-style: none;" class="p-0">
                                <div class="contList d-flex justify-content-between m-0">
                                  <li>Positivos</li>
                                    <div class="contvalueSign me-3 mb-1 d-flex">
                                      <span class="me-1 trustSellPositive"></span>
                                      <i class="bi bi-plus-circle"></i>
                                    </div>
                                </div>
                                
                                <div class="contList d-flex justify-content-between">
                                  <li>Neutrales</li>
                                  <div class="contvalueSign me-3 mb-1 d-flex">
                                    <span class="me-1 trustSellNeutral"></span>
                                    <i class="bi bi-stop-circle"></i>
                                  </div>
                                </div>
                                
                                <div class="contList d-flex justify-content-between">
                                  <li>Negativos</li>
                                  <div class="contvalueSign me-3 mb-1  d-flex">
                                    <span class="me-1 trustSellNegative"></span>
                                    <i class="bi bi-dash-circle"></i>
                                  </div>
                                </div>

                                <hr class="divider">

                                <div class="contList d-flex justify-content-between m-0">
                                  <li>Puntos</li>
                                    <div class="contvalueSign me-3 mb-1 d-flex">
                                      <span class="me-1 scoreSeller">4</span>
                                      <i class="bi bi-p-circle"></i>
                                    </div>
                                </div>

                                <div class="contList d-flex justify-content-between m-0">
                                  <li>Fiabilidad</li>
                                    <div class="contvalueSign me-3 mb-1 d-flex">
                                      <span class="me-1 porcentTrustSeller"></span>
                                    </div>
                                </div>

                                <div class="contList d-flex justify-content-between m-0">
                                  <li>Clasificación</li>
                                    <div class="contvalueSign me-3 mb-1 d-flex">
                                      <span class="me-1 px-1" style="border: 1px solid black; border-radius: 10px;"><small class="ratingSeller"> </small></span>
                                    </div>
                                </div>
                                 
                           
                            </ul>
                          </div>
                          <div class="containerBuyer closed m-1 p-1">
                            <ul style="list-style: none;" class="p-0">
                              <div class="contList d-flex justify-content-between m-0">
                                <li>Positivos</li>
                                  <div class="contvalueSign me-3 mb-1 d-flex">
                                    <span class="me-1 trustBuyPositive"></span>
                                    <i class="bi bi-plus-circle"></i>
                                  </div>
                              </div>

                              <div class="contList d-flex justify-content-between">
                                <li>Neutrales</li>
                                <div class="contvalueSign me-3 mb-1 d-flex">
                                  <span class="me-1 trustBuyNeutral"></span>
                                  <i class="bi bi-stop-circle"></i>
                                </div>
                              </div>
                              
                              <div class="contList d-flex justify-content-between">
                                <li>Negativos</li>
                                <div class="contvalueSign me-3 mb-1  d-flex">
                                  <span class="me-1 trustBuyNegative"></span>
                                  <i class="bi bi-dash-circle"></i>
                                </div>
                              </div>

                              <hr class="divider">

                              <div class="contList d-flex justify-content-between m-0">
                                <li>Puntos</li>
                                  <div class="contvalueSign me-3 mb-1 d-flex">
                                    <span class="me-1 scoreBuyer">11</span>
                                    <i class="bi bi-p-circle"></i>
                                  </div>
                              </div>

                              <div class="contList d-flex justify-content-between m-0">
                                <li>Fiabilidad</li>
                                  <div class="contvalueSign me-3 mb-1 d-flex">
                                    <span class="me-1 porcentTrustBuyer"></span>
                                  </div>
                              </div>

                              <div class="contList d-flex justify-content-between m-0">
                                <li>Clasificación</li>
                                  <div class="contvalueSign me-3 mb-1 d-flex">
                                    <span class="me-1 px-1" style="border: 1px solid black; border-radius: 10px;"><small class="ratingBuyer"> </small></span>
                                  </div>
                              </div>
                         
                          </ul>
                          </div>
                      </div>

                  </div>

                  <div class="col-lg-9 col-md-12 col-sm-12 mt-3 col-12 p-3">
                      
                      <div class="containerFasciVisto" style="max-height: 120vh; overflow-y: auto;">

                        <div class="contentNails">

                          <ul class="nav nav-tabs">
                            <li class="nav-item">
                                <button class="nav-link active" id="btnFascinometro"> Fascinometro</button>
                            </li>
                            <li class="nav-item">
                                <button class="nav-link" id="btnVistometro"> Vistometro</button>
                            </li>
                          </ul>

                        </div>

                        <div class="row m-0 contentFascinometro d-flex" >
                          <!-- Fascinometro -->
                            <div class="col-sm-12 col-md-12 col-lg-8 col-xl-8 col-xxl-8 p-0 fascinometro border" style="position: relative;">

                                <div class="contentP p-2 d-flex justify-content-center align-items-center" style="position: absolute; top : 10px; width: 100%;">
                                  <p class="mb-0" style="font-size: 16; font-weight: 600; color: rgb(102, 102, 102);" >Fascinometro</p>
                                </div>
                        
                                <div class="containerChart">
                                  <div class="chart py-4" style="height: auto;">
                                    <canvas class="chart-favorite"></canvas>
                                  </div>
                                </div>

                            </div>

                            <div class="col-sm-12 col-md-12 col-lg-4 col-xl-4 col-xxl-4 p-0 metric">
                              <table class="table table-striped table-hover tableBox">
                                <thead class="table-danger">
                                    <tr>
                                        <th>Title</th> <th><i class="bi bi-heart-fill"></i></th>
                                    </tr>
                                </thead>
                                <tbody>
                                  <% if (boxPublisher) { %>
                                    <% boxPublisher.forEach((ele)=>{ %>

                                    <tr>
                                        <td><%= ele.title %></td> <td><%= ele.favorite %></td>
                                    </tr>

                                    <% }); %>
                                  <% }; %>  
                                </tbody>
                              </table>
                            </div>

                        </div>
                        
                        <div class="row m-0 contentVistometro d-flex closed">
                          <!-- vistometro -->
                            <div class="col-sm-12 col-md-12 col-lg-8 col-xl-8 col-xxl-8 p-0 vistometro border" style="position: relative;">

                              <div class="contentP p-2 d-flex justify-content-center align-items-center" style="position: absolute; top : 10px; width: 100%;">
                                <p class="mb-0" style="font-size: 16; font-weight: 600; color: rgb(102, 102, 102);" >Vistometro</p>
                              </div>
            
                              <div class="containerChart">
                                  <div class="chart py-4" style="height: auto;">
                                    <canvas class="chart-view"></canvas>
                                  </div>
                              </div>

                            </div>

                            <div class="col-sm-12 col-md-12 col-lg-4 col-xl-4 col-xxl-4 p-0 metric">
                              <table class="table table-striped table-hover tableBox">
                                <thead>
                                    <tr class="table-warning">
                                        <th>Title</th> <th><i class="bi bi-eye-fill"></i></th>
                                    </tr>
                                </thead>
                                <tbody>
                                  <% if (boxPublisher) { %>
                                    <% boxPublisher.forEach((ele)=>{ %>

                                    <tr>
                                        <td><%= ele.title %></td> <td><%= ele.view %></td>
                                    </tr>

                                    <% }); %>
                                  <% }; %>  
                                </tbody>
                              </table>
                            </div>
                            
                        </div>
                      
                      </div>
                      
                      <div class="containerViewRate d-flex flex-column closed border">
                          <div class="containert themaTextLight">
                                <div class="modal-header">
                                  <h6 class="modal-title">Ver Calificaciones y Opiniones</h6>
                                  <i class="bi bi-x-lg cursor-pointer" id= "btnXCloseViewRate"></i>
                                </div>
                                
                                <div class="row m-0 bodyAnalisi d-flex justify-content-between">

                                  <div class="col-xl-3 col-lg-3 col-md-5 col-sm-6 p-0 containerPoint d-flex flex-column justify-content-center align-items-center px-2">
                                      
                                      <p class="pountrateView p-0 mb-1" style="font-size: 40px;"> <!-- 4.8 --> </p>
                                      <div class="boxstarView"> <!-- ***** --> </div>
                                      <p class="countrateView"> <!-- 56 --> </p>

                                  </div>

                                  <div class="col-xl-9 col-lg-9 col-md-6 col-sm-6 p-0 containerRatePercentBar px-3">
                                                                             
                                        <div class="contentBar d-flex my-1" style="height: 25px;">

                                          <span class="p-0 ms-2" style="width: 10%;"> <small class="m-0"> 5 <i class="bi bi-star-fill p-0 m-0"></i> </small>  </span>
                                          <div class="progress py-1 mt-1" id="barStar5" style="width: 90%;">
                                            <!-- dinamico -->
                                          </div>

                                        </div>

                                        <div class="contentBar d-flex my-1" style="height: 25px;">

                                          <span class="p-0 ms-2" style="width: 10%; height: 100%;"> <small class="m-0"> 4 <i class="bi bi-star-fill p-0 m-0"></i> </small>  </span>
                                          <div class="progress py-1 mt-1" id="barStar4" style="width: 90%;">
                                            <!-- dinamico -->
                                          </div>

                                        </div>

                                        <div class="contentBar d-flex my-1" style="height: 25px;">

                                          <span class="p-0 ms-2" style="width: 10%; height: 100%;"> <small class="m-0"> 3 <i class="bi bi-star-fill p-0 m-0"></i> </small>  </span>
                                          <div class="progress py-1 mt-1" id="barStar3" style="width: 90%;">
                                            <!-- dinamico -->
                                          </div>

                                        </div>

                                        <div class="contentBar d-flex my-1" style="height: 25px;">

                                          <span class="p-0 ms-2" style="width: 10%; height: 100%;"> <small class="m-0"> 2 <i class="bi bi-star-fill p-0 m-0"></i> </small>  </span>
                                          <div class="progress py-1 mt-1" id="barStar2" style="width: 90%;">
                                            <!-- dinamico -->
                                          </div>

                                        </div>

                                        <div class="contentBar d-flex my-1" style="height: 25px;">

                                          <span class="p-0 ms-2" style="width: 10%; height: 100%;"> <small class="m-0"> 1 <i class="bi bi-star-fill p-0 m-0"></i> </small>  </span>
                                          <div class="progress py-1 mt-1" id="barStar1" style="width: 90%;">
                                            <!-- dinamico -->
                                          </div>

                                        </div>
                                      
                                  </div>
                                  
                                </div>
                                <div class="row m-0 my-3">
                                  <div class="col-12 d-flex py-2" style="overflow-x: auto;">
                                      <button class="btn btn-secondary rounded-pill px-2 py-1 mx-2 d-flex justify-content-center align-items-center btnRateAll" style="width: 90px; height: 40px;"> <span class="d-flex mx-1">Todos <i class="bi bi-star ms-1"></i> </span> </button>
                                      <button class="btn btn-secondary rounded-pill px-2 py-1 mx-2 d-flex justify-content-center align-items-center btnRate5" style="width: 90px; height: 40px;"> <span class="d-flex mx-1">5 <i class="bi bi-star ms-1"></i> </span> </button>
                                      <button class="btn btn-secondary rounded-pill px-2 py-1 mx-2 d-flex justify-content-center align-items-center btnRate4" style="width: 90px; height: 40px;"> <span class="d-flex mx-1">4 <i class="bi bi-star ms-1"></i> </span> </button>
                                      <button class="btn btn-secondary rounded-pill px-2 py-1 mx-2 d-flex justify-content-center align-items-center btnRate3" style="width: 90px; height: 40px;"> <span class="d-flex mx-1">3 <i class="bi bi-star ms-1"></i> </span> </button>
                                      <button class="btn btn-secondary rounded-pill px-2 py-1 mx-2 d-flex justify-content-center align-items-center btnRate2" style="width: 90px; height: 40px;"> <span class="d-flex mx-1">2 <i class="bi bi-star ms-1"></i> </span> </button>
                                      <button class="btn btn-secondary rounded-pill px-2 py-1 mx-2 d-flex justify-content-center align-items-center btnRate1" style="width: 90px; height: 40px;"> <span class="d-flex mx-1">1 <i class="bi bi-star ms-1"></i> </span> </button>
                                  </div>
                                </div>

                                <div class="bodyRates p-2" id="bodyRates" style="min-height: max-content; max-height: 80vh; overflow-y: auto;">
                                  <!-- dinamico -->
                                </div>
                                

                                <div class="bodyFooter d-flex justify-content-end my-3">
                                    <button type="button" class="btn btn-dark rounded-pill btnCloseViewRate px-4 me-3">Cerrar Calificaciones</button>
                                </div>
                          </div>    
                      </div>
    
                  </div>

              </div>
          </div>
        </div>
      <% } else { %>
       
        <div class="containerMayor d-flex m-5">
          <div class="containerMessage  d-flex align-items-center m-4">
             <div class="Message d-flex flex-column justify-align-center " style="background-color: whitesmoke; border-radius: 6px; padding:15px ; ">
              <p style="color:rgb(99, 98, 98)"><b>¡No puedes acceder a este apartado ya que requiere de un perfil!</b></p>

              <p style="color:rgb(99, 98, 98)" ><b>¿Como obtener un perfil?</b></p>
              
              <div class="containerExplain d-flex">
                <p style="color:rgb(99, 98, 98); text-align: justify;"> En tu menú donde aparece tu username, existe una 
                  opcion llamada “Profile”, crea tu perfil rápido y simple. Luego podrás hacer uso de toda la plataforma.</p>  
                 
                <img src="/img/menuProfileStep.png" style="width: 360px;">
              </div>

            </div>
          </div>
          <div class="containerImage ">
            <img src="/img/sinAccessManage.png" style="width: 600px; ">
          </div>
        </div>
         
      <% }; %>

    <% } else { %>
      <div class="container-fluid d-flex justify-content-center p-3" style="height: 90%; width: 100%; background-color:  rgb(243, 238, 238); box-shadow: 1px 1px 5px 1px rgb(99, 98, 98);  border-top: 2px ridge  rgb(243, 238, 238);">
    
        <%- include('../partials/noLogin.ejs') %>
    
      </div>   
    <% }; %> 

  </main>

  <!-- Este es el cdn de la libreria chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <%- include('../partials/scripts.ejs') %>
  <%- include('../partials/scriptsOnlyNavi-simpleNoIcons.ejs') %>

<% if (user) { %> 
  <% if (searchProfile.length !== 0) { %> 
<script>
  
//esta direccion esta en manage.routes.js       
 const DataFetch = fetch('/myaccount/manage/datafront')
                    .then(response => response.json())
                    .then((jsondata) =>
                     {
                      //console.log(jsondata)
                      //console.log("Aqui la data", jsondata.data);
                      const Data = jsondata.data;
                      const labels= [];
                      const data = [];
                      const view = [];
                      for (let i = 0; i < Data.length; i++) {
                        const element = Data[i];

                        const title = element.title;
                        labels.push(title);
                        const dataX = element.favorite;
                        data.push(dataX);
                        const viewX = element.view;
                        view.push(viewX);
                      }
                      //console.log(labels);
                      //console.log(data);
                      //console.log(view);
                      


    const chartData = {labels,data};

    const myChart = document.querySelector('.chart-favorite');

    new Chart(myChart, {
      type: "doughnut",
      data: {
        labels: chartData.labels,
        datasets: [{ label: "En Favoritos", data: chartData.data}]
      },
      options: {
        responsive: true,
        plugins : {legend: { position: 'bottom'}, title: { display: true }}
      }
    });
    
    const chartDataView = {labels,view};

    const chartView = document.querySelector('.chart-view');

    new Chart(chartView, {
      type: "doughnut",
      data: {
        labels: chartDataView.labels,
        datasets: [{ label: "En Vistas", data: chartDataView.view}]
      },
        options: {
        responsive: true,
        plugins : {legend: { position: 'bottom'}, title: { display: true }}
      }
    });

})
.catch(err => console.log(err)) 



</script>

<script>
  //este script obtiene el record y trust del usuario logeado

    const trustSellPositive = document.querySelector('.trustSellPositive');
    const trustSellNeutral = document.querySelector('.trustSellNeutral');
    const trustSellNegative = document.querySelector('.trustSellNegative');

    const trustBuyPositive = document.querySelector('.trustBuyPositive');
    const trustBuyNeutral = document.querySelector('.trustBuyNeutral');
    const trustBuyNegative = document.querySelector('.trustBuyNegative');

    const scoreBuyer = document.querySelector('.scoreBuyer');
    const scoreSeller = document.querySelector('.scoreSeller');

    const porcentTrustSeller = document.querySelector('.porcentTrustSeller');
    const porcentTrustBuyer = document.querySelector('.porcentTrustBuyer');

    const ratingSeller = document.querySelector('.ratingSeller');
    const ratingBuyer = document.querySelector('.ratingBuyer');
 
   // fetch("/record-trust"  -->Esto se elimino porque requiere cambios


</script>

  <% }; %>
<% }; %>

  <script>
    let btnAdmin = document.getElementById('btnAdmin');
    let btnAnalysis = document.getElementById('btnAnalysis');
    let contentAdmin = document.querySelector('.contentAdmin');
    let contentAnalisys = document.querySelector('.contentAnalisys');
                                                  
    btnAdmin.addEventListener('click', ()=>{
      contentAnalisys.classList.add('closed')
      contentAdmin.classList.remove('closed')

      btnAnalysis.classList.remove('active');
      btnAdmin.classList.add('active');
      
    })

    btnAnalysis.addEventListener('click', ()=>{
      contentAnalisys.classList.remove('closed')
      contentAdmin.classList.add('closed')

      btnAdmin.classList.remove('active');
      btnAnalysis.classList.add('active');
    
    })

  </script>
 
  <script>
    //este script controla la selectividad de la pestaña que presenta al usuario sus datos como vendedor y comprador

    let btnSeller = document.getElementById('btnSeller');
    let btnBuyer = document.getElementById('btnBuyer');
    let contSeller = document.querySelector('.containerSeller');
    let contBuyer = document.querySelector('.containerBuyer');

    btnBuyer.addEventListener('click', ()=>{
      contSeller.classList.add('closed');
      contBuyer.classList.remove('closed');
      btnBuyer.classList.add('active');
      btnSeller.classList.remove('active');
      
    })

    btnSeller.addEventListener('click', ()=>{
      contBuyer.classList.add('closed');
      contSeller.classList.remove('closed');
      btnSeller.classList.add('active');
      btnBuyer.classList.remove('active');
    })

  </script>

  <script>
    //controlador de las pestañas de fascinometro y vistometro

    let btnFascinometro = document.getElementById('btnFascinometro');
    let btnVistometro = document.getElementById('btnVistometro');
    let contentFascinometro = document.querySelector('.contentFascinometro');
    let contentVistometro = document.querySelector('.contentVistometro');

    btnFascinometro.addEventListener('click', ()=>{

      btnFascinometro.classList.add('active');
      btnVistometro.classList.remove('active');

      contentFascinometro.classList.remove('closed');
      contentVistometro.classList.add('closed');

    });

    btnVistometro.addEventListener('click', ()=>{

      btnFascinometro.classList.remove('active');
      btnVistometro.classList.add('active');

      contentFascinometro.classList.add('closed');
      contentVistometro.classList.remove('closed');

    });


  </script>

  <script>

    const btnRateView = document.getElementById('btnRateView');
    const containerFasciVisto = document.querySelector('.containerFasciVisto');
    const containerViewRate = document.querySelector('.containerViewRate');
    const btnXCloseViewRate = document.getElementById('btnXCloseViewRate');
    const btnCloseViewRate = document.querySelector('.btnCloseViewRate');

    btnRateView.addEventListener('click', ()=>{
      containerFasciVisto.classList.add('closed');
      containerViewRate.classList.remove('closed');
    })

    btnXCloseViewRate.addEventListener('click', ()=>{
      containerFasciVisto.classList.remove('closed');
      containerViewRate.classList.add('closed');
      //console.log(containerViewRate.classList.contains('closed'))
    })

    btnCloseViewRate.addEventListener('click', ()=>{
      containerFasciVisto.classList.remove('closed');
      containerViewRate.classList.add('closed');
      //console.log(containerViewRate.classList.contains('closed'))
    })   


  </script>
  
  <!-- script que crea la media de las calificaciones -->
  <script>
    const nameStore = document.getElementById('nameStore');
    const Store = nameStore.value;
    //console.log("Store >", Store);

    const pountrate = document.getElementById('pountrate');
    const boxStar = document.querySelector('.boxStar'); //280
    const messagevalue = document.querySelector('.containerMessagevalue'); //286
          
    const barStar5 = document.getElementById('barStar5'); //elementos donde incertara la barra de progreso
    const barStar4 = document.getElementById('barStar4'); //elementos donde incertara la barra de progreso
    const barStar3 = document.getElementById('barStar3'); //elementos donde incertara la barra de progreso
    const barStar2 = document.getElementById('barStar2'); //elementos donde incertara la barra de progreso
    const barStar1 = document.getElementById('barStar1'); //elementos donde incertara la barra de progreso

    const pountrateView = document.querySelector('.pountrateView');
    const boxstarView = document.querySelector('.boxstarView'); //boxstarView, puntrateView, countrateView
    const countrateView = document.querySelector('.countrateView');
    let sumStar1= 0; sumStar2= 0; sumStar3= 0; sumStar4= 0; sumStar5= 0; //variables que recojeran los datos para luego sacar el porcentaje.
    let percent1, percent2, percent3, percent4, percent5; //pocentajes por estrellas.
    let boxPercent = [];

    // script para conocer la calificacion de esta tienda
    
      const rate = {
        storeName : Store
      };

      fetch('/account/pountRate', {

      method: "post",
      body: JSON.stringify(rate),
      headers: {"content-type" : "application/json"}

      })
      .then(response =>response.json() )
      .then( jsonx =>  { 

          //console.log("recibiendo del backend pountrate ->", jsonx)
          const boxRates = []; //aqui meto todas las calificaciones parseadas a numeros
          jsonx.forEach((ele)=>{
            const markStar = ele.markStar;
            const markstar = parseInt(markStar);
            boxRates.push(markstar)
          })
          //console.log("boxRates", boxRates);
          let ratesLength = boxRates.length;
          //ahora hacemos el calculo para saber cual es la media de las calificaciones aportadas por los usuarios 
          let sumRate = 0;
          boxRates.forEach((ele)=>{
            const stars = ele
            //console.log("stars >", stars)
            sumRate = sumRate + stars; 

            if (ele == 1){
              sumStar1 ++;
            } else if (ele ==2){
              sumStar2 ++;
            } else if (ele ==3){
              sumStar3 ++;
            } else if (ele ==4){
              sumStar4 ++;
            } else if (ele ==5){
              sumStar5 ++;
            } 
          })

          //console.log("Con estos datos armo las barras de progrso de las estrellas.")
          //console.log( `sumStar1 :${sumStar1} sumStar2 :${sumStar2} sumStar3 :${sumStar3} sumStar4 :${sumStar4} sumStar5 :${sumStar5}` );
          //console.log("ratesLength: ", ratesLength);
          //console.log("------------------------------------------------------")
          const boxCountStart = [sumStar1, sumStar2, sumStar3, sumStar4, sumStar5];
          boxCountStart.forEach((ele)=>{
            let resultPercent = ((ele * 100) / ratesLength).toFixed(1);
            boxPercent.push(resultPercent);
          })
          //console.log("boxPercent --->", boxPercent);
          //   1* ,   2* ,    3* ,    4* ,    5*
          //['0.0', '40.0', '20.0', '20.0', '20.0']

          for (let i = 0; i < boxPercent.length; i++) {
            const ele = boxPercent[i];
            //console.log("verrrrrrr aqui", i);
            //console.log(`barStar${i + 1} valor : ${ele} `);
            const x = i + 1;
            if (x == 1){
              barStar1.innerHTML = `<div class="progress-bar rounded-2" role="progressbar" style="width: ${ele}%" aria-valuenow="${ele}" aria-valuemin="0" aria-valuemax="100">  </div>` 
            } else if (x == 2) {
              barStar2.innerHTML = `<div class="progress-bar rounded-2" role="progressbar" style="width: ${ele}%" aria-valuenow="${ele}" aria-valuemin="0" aria-valuemax="100">  </div>` 
            } else if (x == 3) {
              barStar3.innerHTML = `<div class="progress-bar rounded-2" role="progressbar" style="width: ${ele}%" aria-valuenow="${ele}" aria-valuemin="0" aria-valuemax="100">  </div>` 
            } else if (x == 4) {
              barStar4.innerHTML = `<div class="progress-bar rounded-2" role="progressbar" style="width: ${ele}%" aria-valuenow="${ele}" aria-valuemin="0" aria-valuemax="100">  </div>` 
            } else if (x == 5) {
              barStar5.innerHTML = `<div class="progress-bar rounded-2" role="progressbar" style="width: ${ele}%" aria-valuenow="${ele}" aria-valuemin="0" aria-valuemax="100">  </div>` 
            }
                      
            /* `barStar${i}`.innerHTML = `<div class="progress-bar rounded-2" role="progressbar" style="width: ${ele}%" aria-valuenow="${ele}" aria-valuemin="0" aria-valuemax="100">  </div>` */
          }
          


          //console.log("sumRate", sumRate);
          //console.log("ratesLength", ratesLength);
          const pount = (sumRate / ratesLength);
          let pountRate; 
          pountRate = parseFloat( pount.toFixed(1)); 
          //console.log("pountRate", pountRate);
          //console.log("ratesLength", ratesLength);
          //console.log("pountRate", typeof pountRate)
          //boxstarView, puntrateView, countrateView
          pountrateView.innerText = pountRate; //esto muestra la calificacion en la vista dodne estan todas las calificaciones
          countrateView.innerText = ratesLength; //esto muestra la cantidad de calificaciones y opiniones.

          //ratesLength = 1000; para pruebas
          if ( isNaN(pountRate)){
            pountrate.innerText = 0; // es una tienda nueva o sin calificacion alguna.
          } else {
            
            //console.log("Verrr esto ratesLength-->", ratesLength);
            if (ratesLength <= 999){
              pountrate.innerHTML = `${pountRate}/5 <spam style="font-size:12px">(${ratesLength})</spam>`; //eje. 4.5 (16)
            } else if (ratesLength >= 1000 && ratesLength <= 999999 ){
              const reduccion = (ratesLength / 1000)
              const result = reduccion.toFixed(2);
              pountrate.innerHTML = `${pountRate}/5 <spam style="font-size:12px">(${result}K)</spam>`; 
            } else if (ratesLength >= 1000000 && ratesLength <= 999999999 ){
              const reduccion = (ratesLength / 1000000)
              const result = reduccion.toFixed(2);
              pountrate.innerHTML = `${pountRate}/5 <spam style="font-size:12px">(${result}M)</spam>`; 
            }
            
          }
           
          if (isNaN (pountRate)){
            boxStar.innerHTML = ` <i class="bi bi-star mx-3"></i>
                                  <i class="bi bi-star mx-3"></i>
                                  <i class="bi bi-star mx-3"></i>
                                  <i class="bi bi-star mx-3"></i>
                                  <i class="bi bi-star mx-3"></i>
                                  `
            boxstarView.innerHTML = ` <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                    `                      
            messagevalue.innerHTML = `<p class="p-1 alert-secondary">
                                        <span> ¡Tienda Sin Valoración!</span>
                                      </p>` 

          } else if (pountRate == 0 ){
            boxStar.innerHTML = `<i class="bi bi-star-half mx-3"></i>
                                  <i class="bi bi-star mx-3"></i>
                                  <i class="bi bi-star mx-3"></i>
                                  <i class="bi bi-star mx-3"></i>
                                  <i class="bi bi-star mx-3"></i>
                                  `
            boxstarView.innerHTML  = `<i class="bi bi-star-half mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                    `                     
            messagevalue.innerHTML = `<p class="p-1 alert-danger">
                                        <span> ¡Larva del Comercio.!</span>
                                      </p>`          

          } else if (pountRate > 0 && pountRate < 1){
            boxStar.innerHTML = `<i class="bi bi-star-half mx-3"></i>
                                  <i class="bi bi-star mx-3"></i>
                                  <i class="bi bi-star mx-3"></i>
                                  <i class="bi bi-star mx-3"></i>
                                  <i class="bi bi-star mx-3"></i>
                                  `
            boxstarView.innerHTML = ` <i class="bi bi-star-half mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                    `                      
            messagevalue.innerHTML = `<p class="p-1 alert-danger">
                                        <span> ¡Larva del Comercio.!</span>
                                      </p>`   
                 
          } else if (pountRate == 1 ){
            boxStar.innerHTML = ` <i class="bi bi-star-fill mx-3"></i>
                                  <i class="bi bi-star mx-3"></i>
                                  <i class="bi bi-star mx-3"></i>
                                  <i class="bi bi-star mx-3"></i>
                                  <i class="bi bi-star mx-3"></i>
                                  `
            boxstarView.innerHTML = ` <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                    `                      
            messagevalue.innerHTML = `<p class="p-1 alert-danger">
                                        <span> ¡Polilla del Comercio.!</span>
                                      </p>`                      
                            
          } else if (pountRate > 1 && pountRate < 2){
            boxStar.innerHTML = `<i class="bi bi-star-fill mx-3"></i>
                                  <i class="bi bi-star-half mx-3"></i>
                                  <i class="bi bi-star mx-3"></i>
                                  <i class="bi bi-star mx-3"></i>
                                  <i class="bi bi-star mx-3"></i>
                                  `
            boxstarView.innerHTML = ` <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-half mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                    `                      
            messagevalue.innerHTML = `<p class="p-1 alert-danger">
                                        <span> ¡Polilla del Comercio.!</span>
                                      </p>`                      

          } else if (pountRate == 2){
            boxStar.innerHTML = ` <i class="bi bi-star-fill mx-3"></i>
                                  <i class="bi bi-star-fill mx-3"></i>
                                  <i class="bi bi-star mx-3"></i>
                                  <i class="bi bi-star mx-3"></i>
                                  <i class="bi bi-star mx-3"></i>
                                  `
            boxstarView.innerHTML = ` <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                    `                                  
            messagevalue.innerHTML = `<p class="p-1 alert-warning">
                                        <span> ¡Iniciado del Comercio.!</span>
                                      </p>`

          } else if (pountRate > 2 && pountRate < 3){
            boxStar.innerHTML = ` <i class="bi bi-star-fill mx-3"></i>
                                  <i class="bi bi-star-fill mx-3"></i>
                                  <i class="bi bi-star-half mx-3"></i>
                                  <i class="bi bi-star mx-3"></i>
                                  <i class="bi bi-star mx-3"></i>
                                  `
            boxstarView.innerHTML = ` <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-half mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      `                                  
            messagevalue.innerHTML = `<p class="p-1 alert-warning">
                                        <span> ¡Iniciado del Comercio.!</span>
                                      </p>`
                                     
          } else if (pountRate == 3 ){
            boxStar.innerHTML = ` <i class="bi bi-star-fill mx-3"></i>
                                  <i class="bi bi-star-fill mx-3"></i>
                                  <i class="bi bi-star-fill mx-3"></i>
                                  <i class="bi bi-star mx-3"></i>
                                  <i class="bi bi-star mx-3"></i>
                                  `
            boxstarView.innerHTML = ` <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                     `                                   
            messagevalue.innerHTML = `<p class="p-1 alert-warning">
                                        <span> ¡Novato del Comercio.!</span>
                                      </p>` 

          } else if (pountRate > 3 && pountRate < 4){
            boxStar.innerHTML = ` <i class="bi bi-star-fill mx-3"></i>
                                  <i class="bi bi-star-fill mx-3"></i>
                                  <i class="bi bi-star-fill mx-3"></i>
                                  <i class="bi bi-star-half mx-3"></i>
                                  <i class="bi bi-star mx-3"></i>
                                  `
            boxstarView.innerHTML = ` <i class="bi bi-star-fill"></i>
                                      <i class="bi bi-star-fill"></i>
                                      <i class="bi bi-star-fill"></i>
                                      <i class="bi bi-star-half"></i>
                                      <i class="bi bi-star"></i>
                                      `                                  
            messagevalue.innerHTML = `<p class="p-1 alert-warning">
                                        <span> ¡Novato del Comercio.!</span>
                                      </p>`

          } else if (pountRate == 4 ){
            boxStar.innerHTML = ` <i class="bi bi-star-fill mx-3"></i>
                                  <i class="bi bi-star-fill mx-3"></i>
                                  <i class="bi bi-star-fill mx-3"></i>
                                  <i class="bi bi-star-fill mx-3"></i>
                                  <i class="bi bi-star mx-3"></i>
                                  `
            boxstarView.innerHTML = ` <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star mx-1"></i>
                                      `                                    
            messagevalue.innerHTML = `<p class="p-1 alert-success">
                                        <span> ¡Mago del comercio.!</span>
                                      </p>`

          } else if (pountRate > 4 && pountRate < 5){
            boxStar.innerHTML = `<i class="bi bi-star-fill mx-3"></i>
                                  <i class="bi bi-star-fill mx-3"></i>
                                  <i class="bi bi-star-fill mx-3"></i>
                                  <i class="bi bi-star-fill mx-3"></i>
                                  <i class="bi bi-star-half mx-3"></i>
                                  `
            boxstarView.innerHTML = ` <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-half mx-1"></i>
                                      `                                  
            messagevalue.innerHTML = `<p class="p-1 alert-success">
                                        <span> ¡Mago del comercio.!</span>
                                      </p>`

          } else if (pountRate == 5){
            boxStar.innerHTML = `<i class="bi bi-star-fill mx-3"></i>
                                  <i class="bi bi-star-fill mx-3"></i>
                                  <i class="bi bi-star-fill mx-3"></i>
                                  <i class="bi bi-star-fill mx-3"></i>
                                  <i class="bi bi-star-fill mx-3"></i>
                                  `
            boxstarView.innerHTML = ` <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-fill mx-1"></i>
                                      <i class="bi bi-star-fill mx-1"></i>
                                      `                                  
            messagevalue.innerHTML = `<p class="p-1 alert-success">
                                        <span> ¡Supremo del comercio.!</span>
                                      </p>`
          } 

        
        })
      .catch( err => console.log(err));
    

  </script>

  <script>
    const bodyRates = document.getElementById('bodyRates');
    //const nameStore = document.getElementById('nameStore'); arriba declarado
    //const Store = nameStore.value; arriba declarado
    const btnRateAll = document.querySelector('.btnRateAll');
    const btnRate5 = document.querySelector('.btnRate5');
    const btnRate4 = document.querySelector('.btnRate4');
    const btnRate3 = document.querySelector('.btnRate3');
    const btnRate2 = document.querySelector('.btnRate2');
    const btnRate1 = document.querySelector('.btnRate1');
    //console.log("Store >", Store);


      const rateAll = {
        storeName : Store
      };

      fetch('/account/pountRate', {

        method: "post",
        body: JSON.stringify(rateAll),
        headers: {"content-type" : "application/json"}

      })
      .then(response =>response.json() )
      .then( jsonx =>  { 
          
          //console.log("Con estos datos armare la lista de las calificaciones", jsonx);

          jsonx.forEach((ele)=>{

              //console.log("dataLogeado ->", ele.dataLogeado);
              const dataLogeado = ele.dataLogeado;
              const username = dataLogeado.username;
              const mailhash = dataLogeado.mailhash;
              const avatarPerfil = dataLogeado.avatarPerfil;
              //console.log("avatarPerfil >", avatarPerfil);
              //console.log("markStar ->", ele.markStar);
              const markstar = ele.markStar;
              //console.log("markstar -->", markstar) 
              //console.log("comment ->", ele.comment);
              let comment;
              comment = ele.comment;


              if (comment === ""){
                comment = "¡Sin comentarios!"
              } 

              const updatedAt = ele.updatedAt; const date = new Date(updatedAt); 
              let dia = date.getDate(); let mes = date.getMonth() +1; let anio = date.getFullYear();
              const fecha = `${dia}-${mes}-${anio}`;


                  if (avatarPerfil[0].public_id === 'sin_data'){
                      
                      if (markstar == 1){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span>

                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>            
                                        `
                      } else if (markstar == 2){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span>
                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>            
                                        `
                      } else if (markstar == 3){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span> 
                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>            
                                        `
                      } else if (markstar == 4){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                        <i class="bi bi-star-fill"></i>
                                                                        <i class="bi bi-star-fill"></i>
                                                                        <i class="bi bi-star-fill"></i>
                                                                        <i class="bi bi-star"></i> </span>
                                                                        <span class="ms-2"> ${fecha} </span> 
                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>            
                                        `
                      } else if (markstar == 5){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span> 
                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>               
                                        `
                      }   

                  } else {
 
                      if (markstar == 1){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span>

                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>           
                                        ` 
                      } else if (markstar == 2){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span>

                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>           
                                        ` 
                      } else if (markstar == 3){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span>

                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>           
                                        `                   
                      } else if (markstar == 4){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span>

                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>           
                                        `                   
                      } else if (markstar == 5){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span>

                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>           
                                        `                  
                      }
 
                  }            

 
          })


        })
      .catch((error)=>{
        console.log("Ha habido un problema con la carga de calificaciones")
      })

  
        //filtrar por 1 estrellas
        btnRate1.addEventListener('click', ()=>{

            const rate = {
              storeName : Store
            };

            fetch('/account/pountRate/star-1', {

              method: "post",
              body: JSON.stringify(rate),
              headers: {"content-type" : "application/json"}

              })
            .then(response =>response.json() )
            .then( jsonx =>  { 
              
              //console.log("consolta 1 star -> ", jsonx)
              bodyRates.innerHTML = ""; //limpiamos todo antes de colocar los nuevos elementos.
              jsonx.forEach((ele)=>{
                
                const dataLogeado = ele.dataLogeado;
                const avatarPerfil = dataLogeado.avatarPerfil;
                const mailhash = dataLogeado.mailhash;
                const username = dataLogeado.username;

                let comment;
                comment = ele.comment;

                if (comment === ""){
                  comment = "¡Sin comentarios!"
                }

                const updatedAt = ele.updatedAt; const date = new Date(updatedAt); 
                let dia = date.getDate(); let mes = date.getMonth() +1; let anio = date.getFullYear();
                const fecha = `${dia}-${mes}-${anio}`;

                //console.log(`|-> avatarPerfil : ${avatarPerfil} mailhash : ${mailhash} username : ${username}`)

                if (avatarPerfil[0].public_id === 'sin_data'){
                      //carece de avatar customizado usar el hashmail
                      bodyRates.innerHTML += `
                                  <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                    <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                    <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                            <i class="bi bi-star"></i>
                                                            <i class="bi bi-star"></i>
                                                            <i class="bi bi-star"></i>
                                                            <i class="bi bi-star"></i> </span>
                                                            <span class="ms-2"> ${fecha} </span> 
                                    </p>
                                    <p class="mb-1"> <span> ${comment} </span> </p>
                                  </div>               
                                  `

                } else {
                  bodyRates.innerHTML += `
                                  <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                    <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                    <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                            <i class="bi bi-star"></i>
                                                            <i class="bi bi-star"></i>
                                                            <i class="bi bi-star"></i>
                                                            <i class="bi bi-star"></i> </span>
                                                            <span class="ms-2"> ${fecha} </span>

                                    </p>
                                    <p class="mb-1"> <span> ${comment} </span> </p>
                                  </div>           
                                  `   
                }  

              })
               

            })
            .catch((err)=>{ console.log(err) }); 
          


            
        }) 

        //filtrar por 2 estrellas
        btnRate2.addEventListener('click', ()=>{

          const rate = {
            storeName : Store
          };
          
          fetch('/account/pountRate/star-2', {

            method: "post",
            body: JSON.stringify(rate),
            headers: {"content-type" : "application/json"}

            })
          .then(response =>response.json() )
          .then( jsonx =>  {
            
            //console.log("consolta 2 star -> ", jsonx)
            bodyRates.innerHTML = ""; //limpiamos todo antes de colocar los nuevos elementos.
            jsonx.forEach((ele)=>{
              
              const dataLogeado = ele.dataLogeado;
              const avatarPerfil = dataLogeado.avatarPerfil;
              const mailhash = dataLogeado.mailhash;
              const username = dataLogeado.username;

              let comment;
              comment = ele.comment;

              if (comment === ""){
                comment = "¡Sin comentarios!"
              }

              const updatedAt = ele.updatedAt; const date = new Date(updatedAt); 
              let dia = date.getDate(); let mes = date.getMonth() +1; let anio = date.getFullYear();
              const fecha = `${dia}-${mes}-${anio}`;              

              //console.log(`|-> avatarPerfil : ${avatarPerfil} mailhash : ${mailhash} username : ${username}`)

              
              if (avatarPerfil[0].public_id === 'sin_data'){
                    //carece de avatar customizado usar el hashmail
                    bodyRates.innerHTML += `
                                <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                  <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                  <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star"></i>
                                                          <i class="bi bi-star"></i>
                                                          <i class="bi bi-star"></i> </span>
                                                          <span class="ms-2"> ${fecha} </span> 
                                  </p>
                                  <p class="mb-1"> <span> ${comment} </span> </p>
                                </div>               
                                `

              } else {
                bodyRates.innerHTML += `
                                <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                  <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                  <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star"></i>
                                                          <i class="bi bi-star"></i>
                                                          <i class="bi bi-star"></i> </span>
                                                          <span class="ms-2"> ${fecha} </span>

                                  </p>
                                  <p class="mb-1"> <span> ${comment} </span> </p>
                                </div>           
                                `   
              }  

            })
            

           })
          .catch((err)=>{ console.log(err) }); 
        
        }) 
  
        //filtrar por 3 estrellas
        btnRate3.addEventListener('click', ()=>{

          const rate = {
            storeName : Store
          };

          fetch('/account/pountRate/star-3', {

            method: "post",
            body: JSON.stringify(rate),
            headers: {"content-type" : "application/json"}

            })
          .then(response =>response.json() )
          .then( jsonx =>  {
            
            //console.log("consolta 3 star -> ", jsonx)
            bodyRates.innerHTML = ""; //limpiamos todo antes de colocar los nuevos elementos.
            jsonx.forEach((ele)=>{
              
              const dataLogeado = ele.dataLogeado;
              const avatarPerfil = dataLogeado.avatarPerfil;
              const mailhash = dataLogeado.mailhash;
              const username = dataLogeado.username;

              let comment;
              comment = ele.comment;

              if (comment === ""){
                comment = "¡Sin comentarios!"
              }

              const updatedAt = ele.updatedAt; const date = new Date(updatedAt); 
              let dia = date.getDate(); let mes = date.getMonth() +1; let anio = date.getFullYear();
              const fecha = `${dia}-${mes}-${anio}`;              

              //console.log(`|-> avatarPerfil : ${avatarPerfil} mailhash : ${mailhash} username : ${username}`)

              
              if (avatarPerfil[0].public_id === 'sin_data'){
                    //carece de avatar customizado usar el hashmail
                    bodyRates.innerHTML += `
                                <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                  <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                  <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star"></i>
                                                          <i class="bi bi-star"></i> </span>
                                                          <span class="ms-2"> ${fecha} </span> 
                                  </p>
                                  <p class="mb-1"> <span> ${comment} </span> </p>
                                </div>               
                                `

              } else {
                bodyRates.innerHTML += `
                                <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                  <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                  <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star"></i>
                                                          <i class="bi bi-star"></i> </span>
                                                          <span class="ms-2"> ${fecha} </span>

                                  </p>
                                  <p class="mb-1"> <span> ${comment} </span> </p>
                                </div>           
                                `   
              }  

            })

          })
          .catch((err)=>{ console.log(err) }); 

        }) 

        //filtrar por 4 estrellas
        btnRate4.addEventListener('click', ()=>{

          const rate = {
            storeName : Store
          };

          fetch('/account/pountRate/star-4', {

            method: "post",
            body: JSON.stringify(rate),
            headers: {"content-type" : "application/json"}

            })
          .then(response =>response.json() )
          .then( jsonx =>  {
            
            //console.log("consolta 4 star -> ", jsonx)
            bodyRates.innerHTML = ""; //limpiamos todo antes de colocar los nuevos elementos.
            jsonx.forEach((ele)=>{
              
              const dataLogeado = ele.dataLogeado;
              const avatarPerfil = dataLogeado.avatarPerfil;
              const mailhash = dataLogeado.mailhash;
              const username = dataLogeado.username;

              let comment;
              comment = ele.comment;

              if (comment === ""){
                comment = "¡Sin comentarios!"
              }

              const updatedAt = ele.updatedAt; const date = new Date(updatedAt); 
              let dia = date.getDate(); let mes = date.getMonth() +1; let anio = date.getFullYear();
              const fecha = `${dia}-${mes}-${anio}`;              

              //console.log(`|-> avatarPerfil : ${avatarPerfil} mailhash : ${mailhash} username : ${username}`)

              
              if (avatarPerfil[0].public_id === 'sin_data'){
                    //carece de avatar customizado usar el hashmail
                    bodyRates.innerHTML += `
                                <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                  <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                  <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star"></i> </span>
                                                          <span class="ms-2"> ${fecha} </span> 
                                  </p>
                                  <p class="mb-1"> <span> ${comment} </span> </p>
                                </div>               
                                `

              } else {
                bodyRates.innerHTML += `
                                <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                  <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                  <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star"></i> </span>
                                                          <span class="ms-2"> ${fecha} </span>

                                  </p>
                                  <p class="mb-1"> <span> ${comment} </span> </p>
                                </div>           
                                `   
              }  

            })

          })
          .catch((err)=>{ console.log(err) }); 

        }) 

        //filtrar por 5 estrellas
        btnRate5.addEventListener('click', ()=>{

          const rate = {
            storeName : Store
          };

          fetch('/account/pountRate/star-5', {

            method: "post",
            body: JSON.stringify(rate),
            headers: {"content-type" : "application/json"}

            })
          .then(response =>response.json() )
          .then( jsonx =>  {
            
            //console.log("consolta 5 star -> ", jsonx)
            bodyRates.innerHTML = ""; //limpiamos todo antes de colocar los nuevos elementos.
            jsonx.forEach((ele)=>{
              
              const dataLogeado = ele.dataLogeado;
              const avatarPerfil = dataLogeado.avatarPerfil;
              const mailhash = dataLogeado.mailhash;
              const username = dataLogeado.username;

              let comment;
              comment = ele.comment;

              if (comment === ""){
                comment = "¡Sin comentarios!"
              }

              const updatedAt = ele.updatedAt; const date = new Date(updatedAt); 
              let dia = date.getDate(); let mes = date.getMonth() +1; let anio = date.getFullYear();
              const fecha = `${dia}-${mes}-${anio}`;              

              //console.log(`|-> avatarPerfil : ${avatarPerfil} mailhash : ${mailhash} username : ${username}`)

              
              if (avatarPerfil[0].public_id === 'sin_data'){
                    //carece de avatar customizado usar el hashmail
                    bodyRates.innerHTML += `
                                <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                  <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                  <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i> </span>
                                                          <span class="ms-2"> ${fecha} </span> 
                                  </p>
                                  <p class="mb-1"> <span> ${comment} </span> </p>
                                </div>               
                                `

              } else {
                bodyRates.innerHTML += `
                                <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                  <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                  <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i>
                                                          <i class="bi bi-star-fill"></i> </span>
                                                          <span class="ms-2"> ${fecha} </span>

                                  </p>
                                  <p class="mb-1"> <span> ${comment} </span> </p>
                                </div>           
                                `   
              }  

            })

          })
          .catch((err)=>{ console.log(err) }); 

        }) 

        //filtrar por All estrellas
        btnRateAll.addEventListener('click', ()=>{

          const rate = {
            storeName : Store
          };

          fetch('/account/pountRate', {

            method: "post",
            body: JSON.stringify(rate),
            headers: {"content-type" : "application/json"}

            })
          .then(response =>response.json() )
          .then( jsonx =>  {
            
            //console.log("consolta All star -> ", jsonx)
            bodyRates.innerHTML = ""; //limpiamos todo antes de colocar los nuevos elementos.
            jsonx.forEach((ele)=>{
                                   
              const markstar = ele.markStar;
              const dataLogeado = ele.dataLogeado;
              const avatarPerfil = dataLogeado.avatarPerfil;
              const mailhash = dataLogeado.mailhash;
              const username = dataLogeado.username;

              let comment;
              comment = ele.comment;

              if (comment === ""){
                comment = "¡Sin comentarios!"
              }

              const updatedAt = ele.updatedAt; const date = new Date(updatedAt); 
              let dia = date.getDate(); let mes = date.getMonth() +1; let anio = date.getFullYear();
              const fecha = `${dia}-${mes}-${anio}`;              

              //console.log(`|-> avatarPerfil : ${avatarPerfil} mailhash : ${mailhash} username : ${username}`)

              if (avatarPerfil[0].public_id === 'sin_data'){
              console.log("avatarPerfil[0] ", avatarPerfil[0]); 
              console.log("markstar ", markstar);       
                      if (markstar == 1){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span>

                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>            
                                        `
                      } else if (markstar == 2){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span>
                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>            
                                        `
                      } else if (markstar == 3){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span> 
                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>            
                                        `
                      } else if (markstar == 4){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                        <i class="bi bi-star-fill"></i>
                                                                        <i class="bi bi-star-fill"></i>
                                                                        <i class="bi bi-star-fill"></i>
                                                                        <i class="bi bi-star"></i> </span>
                                                                        <span class="ms-2"> ${fecha} </span> 
                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>            
                                        `
                      } else if (markstar == 5){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="https://www.gravatar.com/avatar/${mailhash}?d=identicon" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span> 
                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>               
                                        `
                      }   

                  } else {
 
                      if (markstar == 1){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span>

                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>           
                                        ` 
                      } else if (markstar == 2){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span>

                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>           
                                        ` 
                      } else if (markstar == 3){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star"></i>
                                                                  <i class="bi bi-star"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span>

                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>           
                                        `                   
                      } else if (markstar == 4){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span>

                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>           
                                        `                   
                      } else if (markstar == 5){
                        bodyRates.innerHTML += `
                                        <div class="boxRatesView my-2" style="border-bottom: 2px dotted rgb(211, 211, 211);">
                                          <p class="mb-1"> <img src="${avatarPerfil[0].url}" style="width: 40px;"> <span> ${username} </span> </p>
                                          <p class="mb-1"> <span> <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i>
                                                                  <i class="bi bi-star-fill"></i> </span>
                                                                  <span class="ms-2"> ${fecha} </span>

                                          </p>
                                          <p class="mb-1"> <span> ${comment} </span> </p>
                                        </div>           
                                        `                  
                      }
 
                  }                
              
  


            })

          })
          .catch((err)=>{ console.log(err) }); 

        }) 


        
  </script>

</body>



</html>